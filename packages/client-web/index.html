<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
    <meta name="theme-color" content="#111" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <title>LAF - Live Stations</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=VT323&family=Share+Tech+Mono&display=swap" rel="stylesheet" />
    <style>
      * { margin: 0; padding: 0; box-sizing: border-box; }

      /* Default theme; overridden by user color choice via JS */
      :root {
        --bg: #f5f5f5;
        --surface: #fff;
        --border: #111;
        --text: #111;
        --text-muted: #444;
        --accent: #111;
        --accent-text: #fff;
        --grid-gap: 1rem;
        --topbar-bg: #111;
        --topbar-text: #fff;
        --footer-bg: #111;
        --footer-text: #fff;
        --card-hover: #eee;
        --status-live: #0a7c0a;
        --status-offline: #c00;
      }

      body {
        font-family: Chicago, "Charcoal", "Lucida Grande", system-ui, -apple-system, sans-serif;
        background: var(--bg);
        color: var(--text);
        min-height: 100vh;
        padding-bottom: 80px;
        -webkit-font-smoothing: none;
        font-smoothing: none;
      }
      body.footer-player-hidden { padding-bottom: 0; }

      /* Top bar */
      .site-topbar {
        position: sticky;
        top: 0;
        left: 0;
        right: 0;
        height: 48px;
        background: var(--topbar-bg);
        color: var(--topbar-text);
        border-bottom: 1px solid var(--border);
        display: grid;
        grid-template-columns: 1fr auto;
        align-items: center;
        padding: 0 16px;
        z-index: 20;
        font-size: 13px;
        font-weight: bold;
      }
      .topbar-left {
        display: flex;
        align-items: center;
        gap: 24px;
        min-width: 0;
      }
      .topbar-logo {
        color: var(--topbar-text);
        text-decoration: none;
        font-weight: bold;
        flex-shrink: 0;
      }
      .topbar-logo:hover { opacity: 0.9; }
      .topbar-nav {
        display: flex;
        align-items: center;
        gap: 4px;
      }
      .topbar-nav-item {
        color: var(--topbar-text);
        text-decoration: none;
        padding: 8px 12px;
        border: 1px solid transparent;
      }
      .topbar-nav-item:hover { background: rgba(255,255,255,0.1); }
      .topbar-nav-item.active { background: rgba(255,255,255,0.2); }
      .topbar-chat-toggle {
        width: 28px;
        height: 28px;
        padding: 0;
        border: 1px solid rgba(255,255,255,0.4);
        background: transparent;
        color: var(--topbar-text);
        font-size: 14px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .topbar-chat-toggle:hover { background: rgba(255,255,255,0.1); }
      .topbar-chat-toggle.hidden { display: none !important; }
      .topbar-chat-toggle .chat-icon-retro { display: block; }
      .topbar-center { justify-self: center; display: flex; align-items: center; }
      .topbar-search { width: 140px; max-width: 100%; padding: 4px 0; font-size: 13px; margin: 0; border: none; border-bottom: 1px solid rgba(255,255,255,0.5); border-radius: 0; background: transparent; color: var(--topbar-text); }
      .topbar-search::placeholder { color: rgba(255,255,255,0.5); }
      .topbar-search:focus { outline: none; border-bottom-color: rgba(255,255,255,0.9); }
      /* Macintosh 1984 style: clock and search */
      .topbar-clock {
        font-variant-numeric: tabular-nums;
        font-size: 12px;
        padding: 4px 8px;
        margin: 0 4px;
        border: 1px solid rgba(255,255,255,0.4);
        background: rgba(0,0,0,0.2);
        box-shadow: inset 1px 1px 0 rgba(255,255,255,0.15);
        border-radius: 0;
        min-width: 4.5em;
        text-align: center;
      }
      .topbar-search-wrap {
        display: flex;
        align-items: center;
        gap: 0;
        min-width: 0;
      }
      .topbar-search-toggle {
        width: 28px;
        height: 28px;
        padding: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        border: 1px solid rgba(255,255,255,0.5);
        background: rgba(0,0,0,0.25);
        color: var(--topbar-text);
        font-size: 14px;
        cursor: pointer;
        border-radius: 0;
        box-shadow: inset 1px 1px 0 rgba(255,255,255,0.1);
        flex-shrink: 0;
      }
      .topbar-search-toggle:hover { background: rgba(255,255,255,0.15); }
      .topbar-search-toggle .search-icon-retro { display: block; }
      .topbar-search-field {
        display: none;
        align-items: center;
        margin-left: 6px;
        padding-bottom: 2px;
        border-bottom: 1px solid rgba(255,255,255,0.5);
        background: transparent;
        min-width: 0;
      }
      .topbar-search-wrap.expanded .topbar-search-toggle { margin-right: 0; }
      .topbar-search-wrap.expanded .topbar-search-field { display: flex; }
      .topbar-search-wrap.expanded .topbar-search-field .topbar-search {
        width: 120px;
        min-width: 80px;
        border: none;
        border-bottom: none;
        padding: 2px 4px;
      }
      .topbar-search-field .topbar-search-close {
        width: 20px;
        height: 20px;
        padding: 0;
        margin-left: 2px;
        border: none;
        background: transparent;
        color: rgba(255,255,255,0.7);
        font-size: 14px;
        cursor: pointer;
        line-height: 1;
        flex-shrink: 0;
      }
      .topbar-search-field .topbar-search-close:hover { color: var(--topbar-text); }
      .live-view-toolbar { display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 12px; margin-bottom: 16px; }
      .live-view-toolbar .page-header { margin-bottom: 0; }
      .live-view-toolbar .toolbar-right { display: flex; align-items: center; gap: 12px; flex-wrap: wrap; }
      .view-mode-switcher { display: flex; gap: 4px; flex-wrap: wrap; }
      .view-mode-btn { padding: 6px 12px; font-size: 12px; border-radius: 0; }
      .view-mode-btn.active { background: var(--accent); color: var(--accent-text); border-color: var(--accent); }
      .stations-list-view { display: flex; flex-direction: column; gap: 6px; }
      .stations-list-view.hidden { display: none !important; }
      .station-list-bar { display: flex; align-items: center; justify-content: space-between; gap: 12px; padding: 12px 16px; background: var(--surface); border: 1px solid var(--border); cursor: pointer; text-align: left; font-family: inherit; color: var(--text); width: 100%; }
      .station-list-bar:hover { background: var(--card-hover); }
      .station-list-bar.now-playing { border-width: 2px; font-weight: bold; }
      .station-list-bar .list-bar-name { font-weight: bold; flex: 1; min-width: 0; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
      .station-list-bar .list-bar-location { font-size: 12px; color: var(--text-muted); flex-shrink: 0; }
      .station-list-bar .list-bar-status { font-size: 11px; flex-shrink: 0; }
      .favorites-filter-wrap { display: flex; align-items: center; gap: 8px; font-size: 13px; cursor: pointer; }
      .favorites-filter-wrap input { width: auto; margin: 0; }
      .stations-checking-banner { font-size: 12px; color: var(--text-muted); margin-bottom: 12px; padding: 8px 0; }
      .stations-checking-banner.hidden { display: none !important; }
      .stations-loading-rest {
        grid-column: 1 / -1;
        display: flex;
        align-items: center;
        justify-content: center;
        min-height: 100px;
        padding: 24px;
        background: var(--card-hover);
        border: 1px dashed var(--border);
        border-radius: 10px;
        color: var(--text-muted);
        font-size: 14px;
      }
      .stations-loading-rest-text { animation: loading-pulse 1.2s ease-in-out infinite; }

      /* Initial loading screen (up to 20s on live view) – fixed so visible without scroll */
      .view-live-wrap { position: relative; }
      .initial-loading-screen {
        position: fixed;
        inset: 0;
        z-index: 25;
        background: var(--bg);
        display: flex;
        align-items: center;
        justify-content: center;
        transition: opacity 0.4s ease, visibility 0.4s ease;
      }
      .initial-loading-screen.hidden { opacity: 0; visibility: hidden; pointer-events: none; }
      .initial-loading-inner {
        text-align: center;
        padding: 32px 48px;
        max-width: 320px;
      }
      .initial-loading-logo {
        font-size: 42px;
        font-weight: bold;
        letter-spacing: 0.08em;
        color: var(--text);
        margin-bottom: 16px;
      }
      .initial-loading-text {
        font-size: 15px;
        color: var(--text-muted);
        line-height: 1.4;
        margin-bottom: 24px;
      }
      .initial-loading-bar-wrap {
        height: 3px;
        background: var(--card-hover);
        border-radius: 2px;
        overflow: hidden;
      }
      .initial-loading-bar {
        height: 100%;
        width: 30%;
        border-radius: 2px;
        background: var(--accent);
        animation: initial-load-shimmer 1.8s ease-in-out infinite;
      }
      @keyframes initial-load-shimmer {
        0%, 100% { transform: translateX(-100%); }
        50% { transform: translateX(400%); }
      }
      .stations-grid-unified { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: var(--grid-gap); }
      .stations-grid-unified.hidden { display: none !important; }
      .suggest-card {
        background: var(--surface);
        border: 1px dashed var(--border);
        padding: 20px;
        cursor: pointer;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        text-align: center;
        min-height: 120px;
        color: var(--text-muted);
        font-size: 13px;
        line-height: 1.4;
      }
      .suggest-card:hover { border-style: solid; color: var(--text); background: var(--card-hover); }
      .suggest-card .suggest-card-title { font-weight: bold; margin-bottom: 6px; color: var(--text); }
      /* Global chat overlay (desktop) */
      .chat-global-overlay {
        position: fixed;
        bottom: 80px;
        right: 16px;
        width: 320px;
        max-height: 400px;
        background: var(--surface);
        border: 1px solid var(--border);
        box-shadow: 0 4px 20px rgba(0,0,0,0.15);
        z-index: 18;
        display: none;
        flex-direction: column;
        border-radius: 4px;
        overflow: hidden;
      }
      .chat-global-overlay.open { display: flex; }
      .chat-global-overlay .chat-global-header {
        padding: 10px 12px;
        border-bottom: 1px solid var(--border);
        font-weight: bold;
        font-size: 13px;
        display: flex;
        align-items: center;
        justify-content: space-between;
      }
      .chat-global-overlay .chat-global-close { background: none; border: none; padding: 4px; cursor: pointer; font-size: 18px; }
      .chat-global-overlay .chat-messages { flex: 1; min-height: 120px; max-height: 240px; overflow-y: auto; padding: 8px; }
      .chat-global-overlay .chat-input-row { padding: 8px; border-top: 1px solid var(--border); }
      .chat-global-overlay .chat-input { width: 100%; padding: 8px; font-size: 13px; }
      /* Chat fullscreen (mobile) */
      .chat-global-fullscreen {
        position: fixed;
        inset: 0;
        z-index: 35;
        background: var(--bg);
        display: none;
        flex-direction: column;
        padding-top: env(safe-area-inset-top, 0);
      }
      .chat-global-fullscreen.open { display: flex; }
      .chat-global-fullscreen .chat-global-header { padding: 12px 16px; border-bottom: 1px solid var(--border); font-size: 16px; }
      .chat-global-fullscreen .chat-messages { flex: 1; overflow-y: auto; padding: 12px; }
      .chat-global-fullscreen .chat-input-row { padding: 12px; padding-bottom: calc(12px + env(safe-area-inset-bottom, 0)); }
      .station-card-fav { position: absolute; top: 8px; right: 8px; z-index: 2; background: transparent; border: none; padding: 4px; cursor: pointer; font-size: 18px; line-height: 1; opacity: 0.8; }
      .station-card-fav:hover { opacity: 1; }
      .station-card-fav.favorited { opacity: 1; }
      .topbar-right {
        display: flex;
        align-items: center;
        gap: 8px;
        justify-self: end;
        min-width: 0;
        flex-shrink: 0;
      }
      .color-picker-wrap { position: relative; }
      .color-picker-btn {
        background: transparent;
        border: 1px solid rgba(255,255,255,0.5);
        color: var(--topbar-text);
        padding: 6px 10px;
        font-size: 12px;
        cursor: pointer;
        font-weight: bold;
        font-family: inherit;
        border-radius: 4px;
        display: inline-flex;
        align-items: center;
        gap: 6px;
      }
      .color-picker-btn:hover { background: rgba(255,255,255,0.15); }
      .color-picker-btn .color-picker-preview { width: 14px; height: 14px; border-radius: 2px; border: 1px solid rgba(255,255,255,0.5); flex-shrink: 0; }
      .color-picker-dropdown {
        display: none;
        position: fixed;
        top: calc(var(--topbar-height, 48px) + 8px);
        right: max(16px, env(safe-area-inset-right));
        background: var(--topbar-bg);
        border: 1px solid rgba(255,255,255,0.3);
        border-radius: 6px;
        padding: 10px;
        z-index: 30;
        box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        min-width: 160px;
      }
      .color-picker-dropdown.open { display: block; }
      .color-picker-swatches {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 6px;
      }
      .color-swatch {
        width: 28px;
        height: 28px;
        border-radius: 4px;
        border: 2px solid rgba(255,255,255,0.4);
        cursor: pointer;
        padding: 0;
        -webkit-tap-highlight-color: transparent;
      }
      .color-swatch:hover { border-color: #fff; transform: scale(1.05); }
      .color-picker-custom { margin-top: 10px; padding-top: 10px; border-top: 1px solid rgba(255,255,255,0.3); }
      .color-picker-custom label { font-size: 11px; color: var(--topbar-text); opacity: 0.9; display: block; margin-bottom: 6px; }
      .color-picker-custom input[type="color"] { width: 100%; height: 32px; border: 1px solid rgba(255,255,255,0.4); border-radius: 4px; cursor: pointer; background: transparent; }

      /* Hamburger: visible only on mobile */
      .menu-toggle {
        display: none;
        background: transparent;
        border: none;
        color: var(--topbar-text);
        width: 40px;
        height: 40px;
        padding: 0;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        font-size: 18px;
        font-family: inherit;
        flex-shrink: 0;
        -webkit-tap-highlight-color: transparent;
      }
      .menu-toggle:hover { background: rgba(255,255,255,0.1); }
      .menu-toggle:focus { outline: 2px solid var(--topbar-text); outline-offset: 2px; }
      .nav-backdrop {
        display: none;
        position: fixed;
        inset: 0;
        background: rgba(0,0,0,0.5);
        z-index: 18;
        opacity: 0;
        transition: opacity 0.2s;
      }
      .nav-drawer {
        position: fixed;
        top: 0;
        right: 0;
        width: 280px;
        max-width: 85vw;
        height: 100vh;
        background: var(--topbar-bg);
        color: var(--topbar-text);
        border-left: 1px solid var(--border);
        z-index: 25;
        padding: 24px 16px;
        display: flex;
        flex-direction: column;
        gap: 8px;
        transform: translateX(100%);
        transition: transform 0.25s ease;
        overflow-y: auto;
      }
      .nav-drawer .topbar-nav-item { display: block; padding: 12px 14px; min-height: 44px; box-sizing: border-box; }
      .nav-drawer .color-picker-btn { width: 100%; justify-content: center; min-height: 44px; border-radius: 4px; }
      .drawer-color-swatches { display: none; grid-template-columns: repeat(4, 1fr); gap: 6px; }
      .drawer-color-swatches .color-swatch { width: 100%; max-width: 44px; height: 44px; border-radius: 6px; border: 2px solid rgba(255,255,255,0.4); cursor: pointer; padding: 0; -webkit-tap-highlight-color: transparent; }
      .drawer-color-swatches .color-swatch:hover { border-color: #fff; }
      .drawer-color-custom { display: none; margin-top: 10px; padding-top: 10px; border-top: 1px solid rgba(255,255,255,0.3); }
      .drawer-color-custom label { font-size: 11px; color: var(--topbar-text); opacity: 0.9; display: block; margin-bottom: 6px; }
      .drawer-color-custom input[type="color"] { width: 100%; height: 36px; border: 1px solid rgba(255,255,255,0.4); border-radius: 6px; cursor: pointer; background: transparent; }
      body.nav-open .nav-backdrop { display: block; opacity: 1; }
      body.nav-open .nav-drawer { transform: translateX(0); }

      /* Fullscreen player active: minimal top bar – logo left, clock right only */
      body.fullscreen-player-active .site-topbar .menu-toggle,
      body.fullscreen-player-active .site-topbar .topbar-nav,
      body.fullscreen-player-active .site-topbar .topbar-search-wrap,
      body.fullscreen-player-active .site-topbar .topbar-chat-toggle,
      body.fullscreen-player-active .site-topbar .color-picker-wrap,
      body.fullscreen-player-active .site-topbar .topbar-nav-item,
      body.fullscreen-player-active .site-topbar #client-logout-btn { display: none !important; }
      body.fullscreen-player-active .site-topbar .topbar-clock { display: block !important; }
      body.fullscreen-player-active .site-topbar .topbar-left { gap: 0; }
      body.fullscreen-player-active .site-topbar .topbar-right { gap: 0; }

      /* Main content: 98% of screen width on desktop */
      .main {
        max-width: 98%;
        margin: 0 auto;
        padding: 24px 16px;
      }
      .view { display: none; }
      .view.active { display: block; }

      .page-header {
        font-size: 24px;
        font-weight: bold;
        margin-bottom: 24px;
        padding-bottom: 12px;
        border-bottom: 1px solid var(--border);
      }
      .page-content {
        font-size: 14px;
        line-height: 1.6;
        margin-bottom: 24px;
      }
      .page-content p { margin-bottom: 12px; }
      .page-content a { color: var(--text); text-decoration: underline; }
      .page-content a:hover { opacity: 0.8; }
      .page-content h2 { font-size: 16px; margin: 24px 0 12px; }

      /* Grid sections */
      .section-title {
        font-size: 14px;
        font-weight: bold;
        margin: 32px 0 16px;
        text-transform: uppercase;
        letter-spacing: 0.05em;
      }
      .section-title:first-of-type { margin-top: 0; }

      .channels-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
        gap: var(--grid-gap);
        margin-bottom: 24px;
      }
      .channel-card {
        background: var(--surface);
        border: 1px solid var(--border);
        border-radius: 10px;
        padding: 0;
        cursor: pointer;
        transition: background 0.15s;
        overflow: hidden;
      }
      .channel-card:hover { background: var(--card-hover); }
      .channel-card.now-playing { border-width: 2px; }
      .channel-card .card-title {
        padding: 10px 12px;
        font-size: 13px;
        font-weight: bold;
        border-bottom: 1px solid var(--border);
      }
      .channel-card .card-body { padding: 12px 14px; }
      .channel-card-cover {
        display: block;
        width: 100%;
        max-height: 100px;
        object-fit: cover;
        margin-bottom: 8px;
        border: 1px solid var(--border);
      }
      .channel-desc { font-size: 12px; color: var(--text-muted); line-height: 1.4; }
      .live-badge {
        display: inline-block;
        background: var(--accent);
        color: var(--accent-text);
        padding: 2px 8px;
        font-size: 11px;
        font-weight: bold;
        margin-top: 6px;
      }

      .stations-search {
        width: 100%;
        max-width: 320px;
        padding: 10px 12px;
        margin-bottom: 16px;
        border: 1px solid var(--border);
        background: var(--surface);
        color: var(--text);
        font-size: 14px;
        font-family: inherit;
      }
      .stations-search::placeholder { color: var(--text-muted); }
      .stations-loading-message { text-align: center; padding: 48px 24px; font-size: 16px; color: var(--text-muted); }
      .stations-loading-message .stations-loading-text { animation: loading-pulse 1.2s ease-in-out infinite; }
      .stations-loading-count { display: block; margin-top: 8px; font-size: 14px; opacity: 0.9; }
      @keyframes loading-pulse { 0%, 100% { opacity: 0.7; } 50% { opacity: 1; } }
      .external-stations-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
        gap: var(--grid-gap);
      }
      .external-station-card {
        background: var(--surface);
        border: 1px solid var(--border);
        border-radius: 10px;
        padding: 12px 14px;
        cursor: pointer;
        transition: background 0.15s;
        overflow: hidden;
      }
      .external-station-card:hover { background: var(--card-hover); }
      .external-station-card.now-playing { border-width: 2px; }
      .external-station-card .ext-station-logo-wrap {
        position: relative;
        width: 48px;
        height: 48px;
        margin-bottom: 8px;
      }
      .external-station-card .ext-station-logo {
        display: block;
        width: 48px;
        height: 48px;
        object-fit: contain;
      }
      .external-station-card .ext-station-initial {
        position: absolute;
        inset: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 22px;
        font-weight: bold;
        color: var(--text);
        background: var(--card-hover);
      }
      .external-station-card .ext-station-initial.hidden { display: none; }
      .external-station-card .ext-station-name-only {
        font-size: 16px;
        font-weight: bold;
        margin-bottom: 8px;
        line-height: 1.3;
      }
      .external-station-card .ext-name { font-size: 13px; font-weight: bold; margin-bottom: 6px; }
      .external-station-card .ext-location { font-size: 11px; color: var(--text-muted); margin-bottom: 4px; }
      .external-station-card .ext-desc { font-size: 12px; color: var(--text-muted); line-height: 1.4; }
      .external-station-card .ext-link { font-size: 11px; margin-top: 8px; color: var(--text-muted); text-decoration: underline; }
      .external-station-card .ext-link:hover { color: var(--text); }
      .external-station-card .ext-stream-status { font-size: 11px; margin-top: 6px; font-weight: bold; }
      .external-station-card .ext-stream-status.status-checking,
      .external-station-card .ext-stream-status.status-unknown { color: var(--text-muted); }
      .external-station-card .ext-stream-status.status-live { color: var(--status-live); }
      .external-station-card .ext-stream-status.status-offline,
      .external-station-card .ext-stream-status.status-error,
      .external-station-card .ext-stream-status.status-timeout { color: var(--status-offline); }
      .external-station-card.stream-offline { opacity: 0.85; }
      .ext-card-loading-overlay {
        position: absolute; inset: 0;
        background: rgba(255,255,255,0.92);
        display: flex; align-items: center; justify-content: center;
        font-size: 12px; font-weight: bold; color: var(--text-muted);
        pointer-events: none;
        opacity: 0;
        transition: opacity 0.2s ease;
        border-radius: inherit;
      }
      .external-station-card.card-loading .ext-card-loading-overlay { opacity: 1; }
      .external-station-card.ext-card-hidden-by-filter { display: none !important; }
      .external-station-card-multi .ext-channels-toggle {
        margin-top: 8px;
        padding: 6px 10px;
        width: 100%;
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 8px;
        font-size: 12px;
        font-family: inherit;
        text-align: left;
        background: var(--bg);
        border: 1px solid var(--border);
        color: var(--text);
        cursor: pointer;
        box-sizing: border-box;
      }
      .external-station-card-multi .ext-channels-toggle:hover { background: var(--card-hover); }
      .external-station-card-multi .ext-channels-toggle .ext-channels-chevron { transition: transform 0.2s; }
      .external-station-card-multi.ext-channels-open .ext-channels-toggle .ext-channels-chevron { transform: rotate(180deg); }
      .external-station-card-multi .ext-channels-list { margin-top: 0; border-top: 1px solid var(--border); padding-top: 8px; display: none; flex-direction: column; gap: 4px; }
      .external-station-card-multi.ext-channels-open .ext-channels-list { display: flex; }
      .ext-channel-row {
        display: flex; align-items: center; justify-content: space-between; gap: 8px;
        padding: 6px 10px; text-align: left; font-size: 12px; font-family: inherit;
        background: var(--bg); border: 1px solid var(--border); color: var(--text);
        cursor: pointer; width: 100%; box-sizing: border-box;
      }
      .ext-channel-row:hover { background: var(--card-hover); }
      .ext-channel-row.now-playing { border-width: 2px; font-weight: bold; }
      .ext-channel-row .ext-channel-name { flex: 1; min-width: 0; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
      .ext-channel-row .ext-stream-status { margin: 0; font-size: 10px; flex-shrink: 0; }

      /* Fixed footer player – source: fixed black/white (no CSS variables) so it never follows theme.
         Breakpoints: mobile layout at max-width 768px and 480px; bar stays black at all widths. */
      .footer-player {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        height: 72px;
        background: #000;
        color: #fff;
        border-top: 1px solid rgba(255,255,255,0.2);
        display: grid;
        grid-template-columns: 32px 72px 1fr auto auto;
        align-items: center;
        gap: 12px;
        padding: 0 12px;
        padding-bottom: env(safe-area-inset-bottom, 0);
        z-index: 15;
        transition: transform 0.2s ease, opacity 0.2s ease;
      }
      .footer-player.hidden { display: none !important; }
      /* Tap area is a full-cover button; must be transparent so footer bar stays black (generic button uses var(--surface)). */
      .footer-player .player-bar-tap-area { display: none; background: transparent; background-color: transparent; border: none; color: inherit; }
      .player-expand-btn {
        width: 32px;
        height: 32px;
        min-width: 32px;
        min-height: 32px;
        padding: 0;
        background: transparent;
        border: none;
        color: #fff;
        opacity: 0.9;
        font-size: 18px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        -webkit-tap-highlight-color: transparent;
      }
      .player-expand-btn:hover { opacity: 1; color: #fff; }
      .player-expand-btn[aria-expanded="true"] { transform: rotate(180deg); opacity: 1; color: #fff; }
      /* Expanded player panel – source: fixed black/white (no CSS variables) */
      .player-expanded {
        position: fixed;
        bottom: 72px;
        left: 0;
        right: 0;
        max-height: calc(85vh - 72px);
        overflow-y: auto;
        overflow-x: hidden;
        -webkit-overflow-scrolling: touch;
        background: #000;
        color: #fff;
        border-top: 1px solid rgba(255,255,255,0.2);
        padding: 20px 16px;
        padding-bottom: calc(20px + env(safe-area-inset-bottom, 0));
        z-index: 14;
        display: none;
      }
      .player-expanded.open { display: block; }
      .player-expanded-inner {
        display: flex;
        flex-direction: row;
        align-items: center;
        justify-content: center;
        gap: 24px;
        max-width: 560px;
        margin: 0 auto;
        text-align: left;
      }
      .player-expanded-inner .player-expanded-cover-wrap { flex-shrink: 0; }
      .player-expanded-inner .player-expanded-info { flex: 1; min-width: 0; text-align: left; }
      .player-expanded-inner .player-expanded-controls { flex-shrink: 0; }
      .player-expanded.fullscreen-mobile .player-expanded-inner {
        flex-direction: column;
        text-align: center;
      }
      .player-expanded.fullscreen-mobile .player-expanded-inner .player-expanded-info { text-align: center; }
      .player-expanded.fullscreen-mobile {
        bottom: 0;
        top: var(--topbar-height, 48px);
        left: 0;
        right: 0;
        max-height: none;
        height: calc(100dvh - var(--topbar-height, 48px));
        padding: 16px;
        padding-left: calc(16px + env(safe-area-inset-left, 0));
        padding-right: calc(16px + env(safe-area-inset-right, 0));
        padding-bottom: calc(72px + env(safe-area-inset-bottom, 0));
        z-index: 25;
        display: none;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        overflow: hidden;
        overscroll-behavior: contain;
        -webkit-overflow-scrolling: touch;
      }
      .player-expanded.fullscreen-mobile.open {
        display: flex;
      }
      .player-expanded.fullscreen-mobile .player-expanded-inner {
        flex: 0 1 auto;
        min-height: 0;
        max-width: 100%;
        overflow-y: auto;
        -webkit-overflow-scrolling: touch;
        padding-bottom: calc(72px + env(safe-area-inset-bottom, 0));
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
      }
      .player-expanded.fullscreen-mobile .player-expanded-minimize {
        display: flex !important;
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        height: calc(56px + env(safe-area-inset-bottom, 0));
        min-height: 56px;
        padding-bottom: env(safe-area-inset-bottom, 0);
        background: #000;
        color: #fff;
        border-top: 1px solid rgba(255,255,255,0.2);
        align-items: center;
        justify-content: center;
        z-index: 2;
        flex-shrink: 0;
      }
      .player-expanded.fullscreen-mobile .player-expanded-minimize-btn {
        min-width: 48px;
        min-height: 48px;
        padding: 0;
        border: none;
        background: transparent;
        color: #fff;
        font-size: 22px;
        cursor: pointer;
        -webkit-tap-highlight-color: transparent;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .player-expanded-inner { min-width: 0; }
      .player-expanded-cover-wrap { width: 140px; height: 140px; background: #1a1a1a; border: 1px solid rgba(255,255,255,0.2); overflow: hidden; flex-shrink: 0; border-radius: 4px; }
      .player-expanded-cover-wrap img { width: 100%; height: 100%; object-fit: contain; }
      .player-expanded-info { text-align: center; min-width: 0; width: 100%; }
      .player-expanded-title { font-size: 18px; font-weight: bold; margin-bottom: 6px; word-wrap: break-word; overflow-wrap: break-word; color: #fff; }
      .player-expanded-location { font-size: 12px; color: #fff; opacity: 0.9; margin-bottom: 6px; }
      .player-expanded-desc { font-size: 13px; line-height: 1.45; margin-bottom: 12px; max-height: 4.5em; overflow-y: auto; color: #fff; opacity: 0.9; }
      .player-expanded-link { font-size: 13px; color: #fff; text-decoration: underline; display: inline-block; padding: 4px 0; }
      .player-expanded-buffer-hint { font-size: 11px; color: #fff; opacity: 0.75; margin-top: 8px; }
      .player-expanded-buffer-hint.hidden { display: none !important; }
      .player-expanded-controls { display: flex; gap: 16px; align-items: center; justify-content: center; flex-shrink: 0; }
      .player-expanded-controls button {
        min-width: 48px;
        min-height: 48px;
        padding: 12px 20px;
        background: transparent;
        color: #fff;
        border: 1px solid #fff;
        font-size: 14px;
        cursor: pointer;
        -webkit-tap-highlight-color: transparent;
        touch-action: manipulation;
      }
      .player-expanded-controls button:hover { background: rgba(255,255,255,0.15); }
      .footer-player .cover-wrap {
        position: relative;
        width: 56px;
        height: 56px;
        background: #1a1a1a;
        border: 1px solid rgba(255,255,255,0.2);
        display: flex;
        align-items: center;
        justify-content: center;
        overflow: hidden;
      }
      .footer-player .cover-wrap.placeholder { background: #1a1a1a; }
      .footer-player .cover-wrap img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }
      .footer-player .cover-wrap.placeholder img { display: none; }
      .footer-player .cover-wrap.external-logo img { object-fit: contain; }
      .footer-player .cover-wrap.placeholder::after {
        content: "";
      }
      .footer-player .cover-initial {
        position: absolute;
        inset: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
        font-weight: bold;
      }
      .footer-player .cover-initial.hidden { display: none; }
      .footer-player .info { min-width: 0; }
      .footer-player .info .title { font-size: 14px; font-weight: bold; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; color: #fff; }
      .footer-player .info .desc { font-size: 11px; color: #fff; opacity: 0.9; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
      .footer-player .controls {
        display: flex;
        align-items: center;
        gap: 8px;
      }
      .footer-player .controls button {
        min-width: 44px;
        min-height: 44px;
        background: transparent;
        color: #fff;
        border: 1px solid #fff;
        padding: 8px 14px;
        font-size: 12px;
        font-weight: bold;
        font-family: inherit;
        cursor: pointer;
        -webkit-tap-highlight-color: transparent;
      }
      .footer-player .controls button:hover { background: rgba(255,255,255,0.15); color: #fff; }
      .footer-player .controls button:disabled { opacity: 0.5; cursor: not-allowed; }
      .footer-player .status-text { font-size: 11px; color: #fff; opacity: 0.9; max-width: 120px; text-align: right; }
      .play-pause-icon { display: inline-flex; align-items: center; justify-content: center; width: 1.2em; height: 1.2em; }
      .play-pause-icon svg { width: 100%; height: 100%; }

      /* Expandable player details (optional, below footer or in a slide-out) */
      .player-detail {
        padding: 16px;
        background: var(--surface);
        border-top: 1px solid var(--border);
        display: none;
      }
      .player-detail.open { display: block; }
      .player-detail .stat-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
        gap: 8px;
        margin-top: 12px;
      }
      .player-detail .stat-item {
        background: var(--bg);
        border: 1px solid var(--border);
        padding: 8px 10px;
      }
      .player-detail .stat-label { font-size: 10px; color: var(--text-muted); text-transform: uppercase; margin-bottom: 4px; }
      .player-detail .stat-value { font-size: 13px; font-weight: bold; font-variant-numeric: tabular-nums; }
      .player-detail .chat-panel { margin-top: 16px; border-top: 1px solid var(--border); padding-top: 12px; }
      .player-detail .chat-title { font-size: 12px; font-weight: bold; margin-bottom: 8px; }
      .player-detail .chat-messages {
        height: 100px;
        overflow-y: auto;
        background: var(--bg);
        border: 1px solid var(--border);
        padding: 8px;
        font-size: 12px;
        margin-bottom: 8px;
      }
      .player-detail .chat-message { margin-bottom: 4px; word-break: break-word; }
      .player-detail .chat-message .chat-author { font-weight: bold; margin-right: 6px; }
      .player-detail .chat-signin-prompt { font-size: 11px; color: var(--text-muted); margin-bottom: 8px; }
      .player-detail .chat-input-row { display: flex; gap: 8px; }
      .player-detail .chat-input { flex: 1; padding: 6px 10px; border: 1px solid var(--border); font-size: 12px; background: var(--surface); color: var(--text); }
      .player-detail .chat-send { padding: 6px 12px; font-size: 12px; cursor: pointer; border: 1px solid var(--border); font-weight: bold; background: var(--surface); color: var(--text); }

      /* Buttons */
      button {
        background: var(--surface);
        color: var(--text);
        border: 1px solid var(--border);
        padding: 8px 16px;
        font-size: 12px;
        font-weight: bold;
        font-family: inherit;
        cursor: pointer;
      }
      button:hover { background: var(--card-hover); }
      button:disabled { opacity: 0.6; cursor: not-allowed; }

      .confirm-overlay {
        display: none;
        position: fixed;
        inset: 0;
        background: rgba(0,0,0,0.5);
        z-index: 1000;
        align-items: center;
        justify-content: center;
      }
      .confirm-overlay.visible { display: flex; }
      .confirm-dialog {
        background: var(--surface);
        border: 1px solid var(--border);
        padding: 20px 24px;
        max-width: 360px;
      }
      .confirm-dialog .confirm-title { font-size: 14px; font-weight: bold; margin-bottom: 10px; }
      .confirm-dialog .confirm-message { font-size: 12px; margin-bottom: 16px; line-height: 1.4; }
      .confirm-dialog .confirm-buttons { display: flex; gap: 10px; justify-content: flex-end; }
      .form-group { margin-bottom: 10px; }
      .form-group label { display: block; margin-bottom: 4px; font-weight: bold; font-size: 12px; }
      .form-group input,
      .form-group textarea {
        width: 100%;
        padding: 8px 10px;
        border: 1px solid var(--border);
        background: var(--surface);
        color: var(--text);
        font-family: inherit;
      }
      .form-group textarea { resize: vertical; min-height: 60px; }
      .status { font-size: 13px; padding: 8px 10px; border: 1px solid var(--border); }
      .status.status-info { background: var(--card-hover); color: var(--text); }
      .status.status-error { background: rgba(200,0,0,0.1); color: var(--status-offline); border-color: var(--status-offline); }
      .auth-error { color: var(--status-offline); font-size: 12px; margin-top: 8px; }
      .auth-tab { padding: 6px 12px; border: 1px solid var(--border); background: var(--card-hover); cursor: pointer; font-weight: bold; }
      .auth-tab.active { background: var(--surface); }
      .admin-toolbar { margin-bottom: 16px; }
      .admin-toolbar-row { display: flex; flex-wrap: wrap; align-items: center; gap: 10px 16px; }
      .admin-label { font-size: 12px; color: var(--text-muted); white-space: nowrap; }
      .admin-search-input { min-width: 180px; padding: 6px 10px; font-size: 13px; border: 1px solid var(--border); background: var(--bg); color: var(--text); border-radius: 4px; }
      .admin-select { padding: 6px 10px; font-size: 13px; border: 1px solid var(--border); background: var(--bg); color: var(--text); border-radius: 4px; min-width: 120px; }
      .admin-delete-selected { padding: 6px 12px; font-size: 13px; background: rgba(180,0,0,0.15); color: var(--status-offline); border: 1px solid var(--status-offline); border-radius: 4px; cursor: pointer; }
      .admin-delete-selected:hover:not(:disabled) { background: rgba(180,0,0,0.25); }
      .admin-delete-selected.hidden { display: none !important; }
      .admin-stations-list { display: flex; flex-direction: column; gap: 8px; }
      .admin-station-row { display: grid; grid-template-columns: auto 1fr auto auto; align-items: center; gap: 12px; padding: 10px 12px; background: var(--surface); border: 1px solid var(--border); font-size: 13px; }
      .admin-station-row .admin-station-edit-form { grid-column: 1 / -1; }
      .admin-station-row .admin-station-info { min-width: 0; display: flex; flex-direction: column; gap: 2px; }
      .admin-station-row .name { font-weight: bold; min-width: 0; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
      .admin-station-row .stream-url { font-size: 11px; color: var(--text-muted); min-width: 0; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
      .admin-station-row .admin-station-badge { font-size: 10px; color: var(--text-muted); margin-top: 2px; }
      .admin-station-row .admin-station-actions { display: flex; gap: 8px; flex-shrink: 0; align-items: center; }
      .admin-station-row button { flex-shrink: 0; }
      .admin-station-row .admin-btn-play { padding: 6px 10px; font-size: 12px; }
      .admin-analytics-section { margin-bottom: 32px; max-width: 900px; }
      .admin-analytics-section .section-title { margin-bottom: 12px; }
      .admin-analytics-loading { color: var(--text-muted); font-size: 13px; margin-bottom: 12px; }
      .admin-analytics-stats { display: flex; flex-wrap: wrap; gap: 24px 32px; margin-bottom: 20px; }
      .admin-analytics-stat { display: flex; flex-direction: column; gap: 4px; }
      .admin-analytics-stat-value { font-size: 24px; font-weight: bold; color: var(--text); }
      .admin-analytics-stat-label { font-size: 12px; color: var(--text-muted); }
      .admin-analytics-subtitle { font-size: 14px; font-weight: bold; margin-bottom: 8px; color: var(--text); }
      .admin-analytics-table-wrap { overflow-x: auto; }
      .admin-analytics-table { width: 100%; border-collapse: collapse; font-size: 13px; }
      .admin-analytics-table th, .admin-analytics-table td { padding: 8px 12px; text-align: left; border-bottom: 1px solid var(--border); }
      .admin-analytics-table th { font-weight: bold; color: var(--text-muted); }
      .admin-analytics-table td.count { text-align: right; }

      .hidden { display: none !important; }

      /* ──────────────────────────────────────────────────────────
         CAR RADIO THEME – Full-page skeuomorphic head unit
         Inspired by Blaupunkt Frankfurt RCM 82 DAB
         ────────────────────────────────────────────────────────── */

      /* When car-radio is active, hide the normal UI and go full black */
      body.theme-car-radio { background: #000 !important; padding-bottom: 0 !important; overflow: hidden; }
      body.theme-car-radio .site-topbar,
      body.theme-car-radio .main,
      body.theme-car-radio .footer-player,
      body.theme-car-radio .player-expanded,
      body.theme-car-radio .player-detail,
      body.theme-car-radio .color-picker-dropdown,
      body.theme-car-radio .nav-drawer,
      body.theme-car-radio .nav-backdrop,
      body.theme-car-radio .chat-global-overlay,
      body.theme-car-radio .chat-global-fullscreen,
      body.theme-car-radio .initial-loading-screen { display: none !important; }

      /* ── Car Radio UI container ── */
      .car-radio-ui {
        position: fixed;
        inset: 0;
        background: #000;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        z-index: 100;
        font-family: -apple-system, 'Segoe UI', system-ui, sans-serif;
        user-select: none;
        -webkit-user-select: none;
      }

      /* ── The head unit body ── */
      .cr-unit {
        width: 780px;
        max-width: 96vw;
        background: #2a2a2a;
        border-radius: 12px;
        border: 3px solid #1a1a1a;
        box-shadow:
          0 0 0 1px #444,
          0 8px 32px rgba(0,0,0,0.8),
          inset 0 1px 0 rgba(255,255,255,0.06);
        padding: 12px;
        position: relative;
        /* Subtle texture */
        background-image: radial-gradient(circle at 1px 1px, rgba(255,255,255,0.02) 1px, transparent 0);
        background-size: 3px 3px;
      }

      /* ── Top button row ── */
      .cr-top-row {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 8px;
        padding: 0 4px;
      }
      .cr-btn-group { display: flex; gap: 4px; }
      .cr-top-label {
        display: flex;
        align-items: center;
        gap: 8px;
        color: #888;
        font-size: 9px;
        letter-spacing: 0.15em;
        text-transform: uppercase;
      }
      .cr-rds-badge {
        font-size: 7px;
        padding: 1px 4px;
        border: 1px solid #555;
        border-radius: 2px;
        color: #999;
      }
      .cr-top-label-text { color: #aaa; font-weight: 600; }

      /* ── Buttons (3D raised look) ── */
      .cr-btn {
        background: linear-gradient(180deg, #484848 0%, #353535 40%, #2d2d2d 100%) !important;
        border: 1px solid #222 !important;
        border-radius: 3px;
        color: #ccc !important;
        font-size: 9px;
        font-weight: 700;
        letter-spacing: 0.06em;
        text-transform: uppercase;
        padding: 5px 8px;
        cursor: pointer;
        font-family: inherit;
        box-shadow: 0 2px 4px rgba(0,0,0,0.5), inset 0 1px 0 rgba(255,255,255,0.1);
        transition: all 0.08s;
        min-width: 36px;
        text-align: center;
      }
      .cr-btn:hover { background: linear-gradient(180deg, #555 0%, #404040 100%) !important; }
      .cr-btn:active {
        background: linear-gradient(180deg, #2a2a2a 0%, #333 100%) !important;
        box-shadow: inset 0 2px 5px rgba(0,0,0,0.6) !important;
        transform: translateY(1px);
      }
      .cr-btn-small { padding: 4px 7px; font-size: 8px; min-width: 32px; }

      /* ── Main row: knob | LCD | presets ── */
      .cr-main-row {
        display: grid;
        grid-template-columns: 140px 1fr 140px;
        gap: 10px;
        align-items: center;
        min-height: 160px;
      }

      /* ── Left panel: knob + arrows ── */
      .cr-left-panel {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 10px;
      }
      .cr-knob-area { display: flex; flex-direction: column; align-items: center; gap: 4px; }
      .cr-knob-labels {
        display: flex;
        gap: 12px;
        font-size: 7px;
        color: #888;
        letter-spacing: 0.1em;
        text-transform: uppercase;
      }
      .cr-knob {
        width: 64px;
        height: 64px;
        border-radius: 50%;
        background: radial-gradient(circle at 35% 35%, #555, #333 40%, #222 70%, #111);
        border: 2px solid #111;
        box-shadow: 0 4px 12px rgba(0,0,0,0.7), inset 0 0 0 2px rgba(255,255,255,0.05);
        cursor: pointer;
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .cr-knob-inner {
        width: 52px;
        height: 52px;
        border-radius: 50%;
        background: linear-gradient(145deg, #444, #282828);
        position: relative;
      }
      .cr-knob-ring {
        position: absolute;
        inset: 3px;
        border-radius: 50%;
        border: 1.5px solid rgba(200,160,60,0.4);
        box-shadow: 0 0 4px rgba(200,160,60,0.15);
      }
      .cr-knob-dot {
        position: absolute;
        top: 6px;
        left: 50%;
        transform: translateX(-50%) rotate(0deg);
        transform-origin: center 20px;
        width: 4px;
        height: 4px;
        border-radius: 50%;
        background: #c8a03c;
        transition: transform 0.1s ease;
        box-shadow: 0 0 3px rgba(200,160,60,0.6);
      }

      /* ── Nav arrows ── */
      /* ── Seek buttons under knob ── */
      .cr-nav-seek {
        display: flex;
        gap: 6px;
        justify-content: center;
      }
      .cr-btn-seek {
        width: 52px;
        height: 28px;
        font-size: 10px;
        padding: 0;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      /* ── Volume display ── */
      .cr-vol-display {
        font-family: 'Share Tech Mono', 'VT323', 'Courier New', monospace;
        font-size: 10px;
        color: #cc7d1e;
        text-shadow: 0 0 4px rgba(255,157,46,0.3);
        text-align: center;
        margin-top: 4px;
        letter-spacing: 0.1em;
      }

      /* ── Center panel: LCD + slot ── */
      .cr-center-panel {
        display: flex;
        flex-direction: column;
        gap: 8px;
      }

      /* ── LCD Display ── */
      .cr-lcd {
        background: #0c0c00;
        border: 2px solid #333;
        border-radius: 4px;
        padding: 12px 16px;
        min-height: 90px;
        box-shadow:
          inset 0 2px 8px rgba(0,0,0,0.9),
          inset 0 0 20px rgba(0,0,0,0.4),
          0 1px 0 rgba(255,255,255,0.05);
        display: flex;
        flex-direction: column;
        justify-content: center;
        gap: 4px;
        position: relative;
        overflow: hidden;
      }
      /* Scanline overlay */
      .cr-lcd::after {
        content: '';
        position: absolute;
        inset: 0;
        background: repeating-linear-gradient(
          0deg,
          transparent,
          transparent 2px,
          rgba(0,0,0,0.15) 2px,
          rgba(0,0,0,0.15) 4px
        );
        pointer-events: none;
      }
      .cr-lcd-row1 {
        font-family: 'Share Tech Mono', 'VT323', 'Courier New', monospace;
        font-size: 22px;
        color: #ff9d2e;
        text-shadow: 0 0 8px rgba(255,157,46,0.7), 0 0 20px rgba(255,157,46,0.3);
        letter-spacing: 0.12em;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        line-height: 1.2;
      }
      .cr-lcd-row2 {
        font-family: 'Share Tech Mono', 'VT323', 'Courier New', monospace;
        font-size: 12px;
        color: #cc7d1e;
        text-shadow: 0 0 4px rgba(255,157,46,0.4);
        letter-spacing: 0.08em;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        opacity: 0.85;
      }
      .cr-lcd-row3 {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 4px;
      }
      .cr-lcd-freq {
        font-family: 'Share Tech Mono', 'VT323', 'Courier New', monospace;
        font-size: 11px;
        color: #cc7d1e;
        text-shadow: 0 0 4px rgba(255,157,46,0.3);
        letter-spacing: 0.06em;
      }
      .cr-lcd-status {
        font-family: 'Share Tech Mono', 'VT323', 'Courier New', monospace;
        font-size: 10px;
        color: #ff9d2e;
        text-shadow: 0 0 4px rgba(255,157,46,0.5);
        letter-spacing: 0.1em;
        text-transform: uppercase;
      }
      .cr-lcd-status.cr-status-playing { color: #44dd44; text-shadow: 0 0 6px rgba(68,221,68,0.5); }
      .cr-lcd-status.cr-status-stopped { color: #cc7d1e; }
      .cr-lcd-status.cr-status-buffering { color: #ffdd44; text-shadow: 0 0 4px rgba(255,221,68,0.4); }

      /* ── LCD level meter ── */
      .cr-lcd-meter {
        height: 3px;
        background: #1a1400;
        border-radius: 1px;
        margin-top: 6px;
        overflow: hidden;
      }
      .cr-lcd-meter-fill {
        height: 100%;
        width: 0%;
        background: linear-gradient(90deg, #cc7d1e, #ff9d2e, #ffcc44);
        box-shadow: 0 0 4px rgba(255,157,46,0.5);
        transition: width 0.3s ease;
        border-radius: 1px;
      }

      /* ── Cassette slot area ── */
      .cr-slot {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 6px;
      }
      .cr-slot-opening {
        width: 90%;
        height: 6px;
        background: #111;
        border: 1px solid #1a1a1a;
        border-radius: 2px;
        box-shadow: inset 0 1px 3px rgba(0,0,0,0.8);
      }
      .cr-slot-label {
        display: flex;
        align-items: center;
        gap: 10px;
      }
      .cr-brand-badge {
        font-size: 10px;
        font-weight: 800;
        color: #000;
        background: linear-gradient(180deg, #e8a020, #cc7d1e);
        padding: 1px 6px;
        border-radius: 2px;
        letter-spacing: 0.1em;
      }
      .cr-model-text {
        font-size: 8px;
        color: #666;
        letter-spacing: 0.15em;
        text-transform: uppercase;
      }

      /* ── Right panel: Preset buttons ── */
      .cr-right-panel {
        display: flex;
        flex-direction: column;
        gap: 6px;
      }
      .cr-presets {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 4px;
      }
      .cr-preset-btn {
        background: linear-gradient(180deg, #3d3d3d 0%, #2d2d2d 50%, #252525 100%) !important;
        border: 1px solid #1a1a1a !important;
        border-radius: 3px;
        color: #cc7d1e !important;
        font-family: 'Share Tech Mono', 'VT323', 'Courier New', monospace !important;
        font-size: 13px;
        font-weight: 700;
        padding: 8px 4px;
        cursor: pointer;
        box-shadow: 0 2px 5px rgba(0,0,0,0.5), inset 0 1px 0 rgba(255,255,255,0.06);
        transition: all 0.1s;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 2px;
        min-height: 38px;
        position: relative;
      }
      .cr-preset-btn:hover {
        background: linear-gradient(180deg, #4a4a4a 0%, #383838 100%) !important;
        color: #ff9d2e !important;
      }
      .cr-preset-btn:active {
        background: linear-gradient(180deg, #222 0%, #2d2d2d 100%) !important;
        box-shadow: inset 0 2px 6px rgba(0,0,0,0.7) !important;
        transform: translateY(1px);
      }
      .cr-preset-btn.cr-preset-active {
        color: #ff9d2e !important;
        box-shadow: 0 2px 5px rgba(0,0,0,0.5), inset 0 1px 0 rgba(255,255,255,0.06), 0 0 8px rgba(255,157,46,0.15);
      }
      .cr-preset-btn.cr-preset-active::after {
        content: '';
        position: absolute;
        top: 3px;
        right: 3px;
        width: 4px;
        height: 4px;
        border-radius: 50%;
        background: #ff9d2e;
        box-shadow: 0 0 4px rgba(255,157,46,0.8);
      }
      .cr-preset-num { font-size: 14px; line-height: 1; }
      .cr-preset-label {
        font-size: 6px;
        color: #777;
        letter-spacing: 0.05em;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
        max-width: 56px;
      }

      /* ── Bottom play/stop buttons ── */
      .cr-bottom-btns {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 4px;
      }
      .cr-btn-band {
        font-family: 'Share Tech Mono', 'VT323', 'Courier New', monospace !important;
        font-size: 10px;
        padding: 6px 4px;
        letter-spacing: 0.05em;
      }

      /* ── Station list overlay ── */
      .cr-station-list {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 500px;
        max-width: 94vw;
        max-height: 70vh;
        background: #1a1a1a;
        border: 2px solid #444;
        border-radius: 8px;
        box-shadow: 0 12px 48px rgba(0,0,0,0.8);
        z-index: 110;
        display: flex;
        flex-direction: column;
        overflow: hidden;
      }
      .cr-station-list-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 10px 14px;
        border-bottom: 1px solid #333;
        background: #222;
      }
      .cr-station-list-title {
        font-family: 'Share Tech Mono', 'VT323', 'Courier New', monospace;
        color: #ff9d2e;
        text-shadow: 0 0 4px rgba(255,157,46,0.4);
        font-size: 13px;
        letter-spacing: 0.1em;
      }
      .cr-station-list-body {
        overflow-y: auto;
        flex: 1;
        padding: 4px;
      }
      .cr-station-list-body::-webkit-scrollbar { width: 5px; }
      .cr-station-list-body::-webkit-scrollbar-track { background: #1a1a1a; }
      .cr-station-list-body::-webkit-scrollbar-thumb { background: #444; border-radius: 3px; }
      .cr-station-row {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 8px 12px;
        cursor: pointer;
        border-radius: 3px;
        transition: background 0.1s;
        border: none !important;
        background: transparent !important;
        width: 100%;
        text-align: left;
        font-family: inherit;
        box-shadow: none !important;
      }
      .cr-station-row:hover { background: #2a2a2a !important; }
      .cr-station-row.cr-station-active { background: #1a2a1a !important; }
      .cr-station-row-num {
        font-family: 'Share Tech Mono', monospace;
        font-size: 10px;
        color: #555;
        min-width: 24px;
        text-align: right;
      }
      .cr-station-row-name {
        flex: 1;
        font-family: 'Share Tech Mono', monospace;
        font-size: 12px;
        color: #cc7d1e;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }
      .cr-station-row.cr-station-active .cr-station-row-name {
        color: #ff9d2e;
        text-shadow: 0 0 4px rgba(255,157,46,0.4);
      }
      .cr-station-row-loc {
        font-size: 10px;
        color: #555;
        white-space: nowrap;
      }

      /* ──────────────────────────────────────────────────────────
         iPOD CLASSIC THEME – Full-page skeuomorphic iPod
         ────────────────────────────────────────────────────────── */

      /* When iPod is active, hide the normal UI */
      body.theme-ipod { background: #000 !important; padding-bottom: 0 !important; overflow: hidden; }
      body.theme-ipod .site-topbar,
      body.theme-ipod .main,
      body.theme-ipod .footer-player,
      body.theme-ipod .player-expanded,
      body.theme-ipod .player-detail,
      body.theme-ipod .color-picker-dropdown,
      body.theme-ipod .nav-drawer,
      body.theme-ipod .nav-backdrop,
      body.theme-ipod .chat-global-overlay,
      body.theme-ipod .chat-global-fullscreen,
      body.theme-ipod .initial-loading-screen { display: none !important; }

      /* ── iPod container ── */
      .ipod-ui {
        position: fixed;
        inset: 0;
        background: #1a1a1a;
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 100;
        user-select: none;
        -webkit-user-select: none;
      }

      /* ── iPod body (white/silver classic) ── */
      .ipod-body {
        width: 320px;
        max-width: 92vw;
        background: linear-gradient(180deg, #f0f0f0 0%, #e8e8e8 20%, #e0e0e0 80%, #d4d4d4 100%);
        border-radius: 24px;
        border: 1px solid #b0b0b0;
        box-shadow:
          0 0 0 1px rgba(255,255,255,0.6) inset,
          0 12px 40px rgba(0,0,0,0.6),
          0 2px 8px rgba(0,0,0,0.3);
        padding: 24px 20px 28px;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 20px;
        position: relative;
      }
      /* Subtle metallic sheen */
      .ipod-body::before {
        content: '';
        position: absolute;
        top: 0;
        left: 30%;
        right: 30%;
        height: 50%;
        background: linear-gradient(180deg, rgba(255,255,255,0.4), transparent);
        border-radius: 24px 24px 0 0;
        pointer-events: none;
      }

      /* ── iPod Screen ── */
      .ipod-screen {
        width: 100%;
        height: 260px;
        background: #fff;
        border: 2px solid #888;
        border-radius: 6px;
        overflow: hidden;
        box-shadow:
          inset 0 1px 4px rgba(0,0,0,0.15),
          0 1px 0 rgba(255,255,255,0.8);
        display: flex;
        flex-direction: column;
        position: relative;
      }

      /* iPod status bar */
      .ipod-statusbar {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 4px 10px;
        background: linear-gradient(180deg, #b8c6e0, #8fa4c8);
        font-size: 10px;
        font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
        font-weight: 600;
        color: #000;
        flex-shrink: 0;
      }
      .ipod-statusbar-title { flex: 1; text-align: center; }
      .ipod-statusbar-battery {
        width: 20px;
        height: 10px;
        border: 1px solid #555;
        border-radius: 2px;
        position: relative;
        display: flex;
        align-items: center;
        padding: 1px;
      }
      .ipod-statusbar-battery::after {
        content: '';
        position: absolute;
        right: -3px;
        top: 2px;
        width: 2px;
        height: 4px;
        background: #555;
        border-radius: 0 1px 1px 0;
      }
      .ipod-statusbar-battery-fill {
        width: 80%;
        height: 100%;
        background: linear-gradient(180deg, #4cd964, #34c759);
        border-radius: 1px;
      }
      .ipod-statusbar-play {
        font-size: 8px;
        margin-right: 4px;
      }

      /* iPod screen content area */
      .ipod-content {
        flex: 1;
        overflow: hidden;
        position: relative;
        background: #fff;
      }

      /* ── iPod Menu view ── */
      .ipod-menu {
        position: absolute;
        inset: 0;
        display: flex;
        flex-direction: column;
        overflow: hidden;
      }
      .ipod-menu.ipod-hidden { display: none; }
      .ipod-menu-header {
        font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
        font-size: 14px;
        font-weight: 700;
        padding: 6px 12px;
        color: #000;
        border-bottom: 1px solid #ccc;
        flex-shrink: 0;
      }
      .ipod-menu-list {
        flex: 1;
        overflow-y: auto;
        -webkit-overflow-scrolling: touch;
      }
      .ipod-menu-list::-webkit-scrollbar { display: none; }
      .ipod-menu-item {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 8px 12px;
        font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
        font-size: 13px;
        color: #000;
        cursor: pointer;
        border-bottom: 1px solid #e8e8e8;
        transition: none;
        border: none !important;
        background: transparent !important;
        box-shadow: none !important;
        border-radius: 0;
        text-transform: none;
        letter-spacing: normal;
        text-align: left;
        width: 100%;
        font-weight: normal;
      }
      .ipod-menu-item.ipod-selected {
        background: linear-gradient(180deg, #4a8de8, #2968c8) !important;
        color: #fff !important;
      }
      .ipod-menu-item-label { flex: 1; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
      .ipod-menu-item-chevron {
        font-size: 12px;
        color: #999;
        margin-left: 8px;
        flex-shrink: 0;
      }
      .ipod-menu-item.ipod-selected .ipod-menu-item-chevron { color: #fff; }
      .ipod-menu-item-sub {
        font-size: 11px;
        color: #888;
        margin-left: 8px;
        flex-shrink: 0;
      }
      .ipod-menu-item.ipod-selected .ipod-menu-item-sub { color: rgba(255,255,255,0.8); }

      /* ── iPod Now Playing view ── */
      .ipod-nowplaying {
        position: absolute;
        inset: 0;
        display: flex;
        flex-direction: column;
        padding: 10px 14px;
        background: #fff;
      }
      .ipod-nowplaying.ipod-hidden { display: none; }
      .ipod-np-top {
        display: flex;
        gap: 10px;
        margin-bottom: 8px;
        flex-shrink: 0;
      }
      .ipod-np-art {
        width: 80px;
        height: 80px;
        background: linear-gradient(135deg, #ddd, #bbb);
        border: 1px solid #aaa;
        border-radius: 4px;
        overflow: hidden;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
      }
      .ipod-np-art img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }
      .ipod-np-art-initial {
        font-size: 32px;
        font-weight: 700;
        color: #999;
        font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
      }
      .ipod-np-info { flex: 1; min-width: 0; display: flex; flex-direction: column; justify-content: center; gap: 2px; }
      .ipod-np-title {
        font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
        font-size: 14px;
        font-weight: 700;
        color: #000;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }
      .ipod-np-artist {
        font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
        font-size: 12px;
        color: #666;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }
      .ipod-np-album {
        font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
        font-size: 11px;
        color: #999;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      /* Progress bar */
      .ipod-np-progress {
        margin-top: auto;
        flex-shrink: 0;
      }
      .ipod-np-bar-wrap {
        height: 6px;
        background: #ddd;
        border-radius: 3px;
        overflow: hidden;
        margin-bottom: 4px;
      }
      .ipod-np-bar-fill {
        height: 100%;
        background: linear-gradient(180deg, #4a8de8, #2968c8);
        border-radius: 3px;
        width: 0%;
        transition: width 0.5s linear;
      }
      .ipod-np-bar-fill.ipod-np-playing {
        animation: ipod-progress 30s linear infinite;
      }
      @keyframes ipod-progress {
        0% { width: 0%; }
        100% { width: 100%; }
      }
      .ipod-np-times {
        display: flex;
        justify-content: space-between;
        font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
        font-size: 9px;
        color: #999;
      }

      /* Volume bar */
      .ipod-np-volume {
        display: flex;
        align-items: center;
        gap: 6px;
        margin-top: 6px;
        flex-shrink: 0;
      }
      .ipod-np-vol-icon { font-size: 10px; color: #888; flex-shrink: 0; }
      .ipod-np-vol-bar {
        flex: 1;
        height: 4px;
        background: #ddd;
        border-radius: 2px;
        overflow: hidden;
      }
      .ipod-np-vol-fill {
        height: 100%;
        width: 70%;
        background: linear-gradient(90deg, #4a8de8, #6aa8f0);
        border-radius: 2px;
        transition: width 0.2s;
      }

      /* ── iPod Click Wheel ── */
      .ipod-wheel-area {
        width: 220px;
        height: 220px;
        position: relative;
        flex-shrink: 0;
      }
      .ipod-wheel {
        width: 100%;
        height: 100%;
        border-radius: 50%;
        background: linear-gradient(145deg, #e8e8e8, #d0d0d0);
        border: 1px solid #b8b8b8;
        box-shadow:
          inset 0 2px 6px rgba(0,0,0,0.08),
          0 2px 8px rgba(0,0,0,0.15);
        position: relative;
        cursor: pointer;
        -webkit-tap-highlight-color: transparent;
      }

      /* Wheel labels */
      .ipod-wheel-label {
        position: absolute;
        font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
        font-size: 12px;
        font-weight: 600;
        color: #555;
        pointer-events: none;
        user-select: none;
      }
      .ipod-wheel-label-menu { top: 18px; left: 50%; transform: translateX(-50%); }
      .ipod-wheel-label-fwd { right: 16px; top: 50%; transform: translateY(-50%); font-size: 16px; }
      .ipod-wheel-label-back { left: 16px; top: 50%; transform: translateY(-50%); font-size: 16px; }
      .ipod-wheel-label-play { bottom: 18px; left: 50%; transform: translateX(-50%); font-size: 14px; }

      /* Click zones (invisible buttons on the wheel) */
      .ipod-wheel-zone {
        position: absolute;
        background: transparent;
        border: none !important;
        cursor: pointer;
        z-index: 2;
        padding: 0;
        box-shadow: none !important;
        border-radius: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        color: transparent !important;
      }
      .ipod-wheel-zone:active { background: rgba(0,0,0,0.06) !important; }
      .ipod-zone-menu { top: 0; left: 25%; width: 50%; height: 28%; border-radius: 50% 50% 0 0; }
      .ipod-zone-fwd { right: 0; top: 25%; width: 28%; height: 50%; border-radius: 0 50% 50% 0; }
      .ipod-zone-back { left: 0; top: 25%; width: 28%; height: 50%; border-radius: 50% 0 0 50%; }
      .ipod-zone-play { bottom: 0; left: 25%; width: 50%; height: 28%; border-radius: 0 0 50% 50%; }

      /* Center select button */
      .ipod-center-btn {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 80px;
        height: 80px;
        border-radius: 50%;
        background: linear-gradient(145deg, #f0f0f0, #ddd);
        border: 1px solid #c0c0c0 !important;
        box-shadow:
          0 2px 6px rgba(0,0,0,0.15),
          inset 0 1px 2px rgba(255,255,255,0.8) !important;
        cursor: pointer;
        z-index: 3;
        padding: 0;
        color: transparent !important;
      }
      .ipod-center-btn:active {
        background: linear-gradient(145deg, #e0e0e0, #ccc) !important;
        box-shadow: inset 0 2px 4px rgba(0,0,0,0.15) !important;
      }

      /* ── iPod responsive ── */
      @media (max-width: 400px) {
        .ipod-body { padding: 16px 14px 20px; border-radius: 20px; gap: 14px; }
        .ipod-screen { height: 220px; }
        .ipod-wheel-area { width: 190px; height: 190px; }
        .ipod-center-btn { width: 66px; height: 66px; }
        .ipod-wheel-label { font-size: 10px; }
        .ipod-wheel-label-menu { top: 14px; }
        .ipod-wheel-label-play { bottom: 14px; }
        .ipod-wheel-label-fwd { right: 12px; font-size: 14px; }
        .ipod-wheel-label-back { left: 12px; font-size: 14px; }
      }
      @media (max-height: 600px) {
        .ipod-body { padding: 12px 14px 16px; gap: 10px; }
        .ipod-screen { height: 180px; }
        .ipod-wheel-area { width: 170px; height: 170px; }
        .ipod-center-btn { width: 60px; height: 60px; }
      }

      /* ── Popup mini-player button ── */
      .popup-btn {
        background: transparent;
        border: 1px solid rgba(255,255,255,0.5);
        color: var(--topbar-text);
        padding: 6px 8px;
        font-size: 14px;
        cursor: pointer;
        font-family: inherit;
        border-radius: 4px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        line-height: 1;
      }
      .popup-btn:hover { background: rgba(255,255,255,0.15); }
      .popup-btn-icon { font-size: 14px; }

      /* ── Popup window mode: when opened via window.open, compact layout ── */
      body.popup-mode {
        padding-bottom: 0 !important;
        overflow: hidden !important;
      }
      /* In popup mode, car radio fits snugly */
      body.popup-mode .car-radio-ui { background: #1a1a1a; }
      body.popup-mode .cr-unit {
        max-width: 100%;
        width: 100%;
        border-radius: 0;
        border: none;
        box-shadow: none;
      }
      /* In popup mode, iPod fits snugly */
      body.popup-mode .ipod-ui { background: #111; }
      body.popup-mode .ipod-body {
        max-width: 100%;
        border-radius: 12px;
      }
      /* Hide POP button when already in popup */
      body.popup-mode .cr-btn-pop,
      body.popup-mode .popup-btn { display: none !important; }
      /* Car radio popup: highlight POP button */
      .cr-btn-pop {
        color: #ffcc44 !important;
        border-color: #555 !important;
      }
      .cr-btn-pop:hover {
        color: #ffe066 !important;
      }

      /* ── Theme toggle button (works in both themes) ── */
      .theme-toggle-btn {
        background: transparent;
        border: 1px solid rgba(255,255,255,0.5);
        color: var(--topbar-text);
        padding: 6px 10px;
        font-size: 12px;
        cursor: pointer;
        font-weight: bold;
        font-family: inherit;
        border-radius: 4px;
        display: inline-flex;
        align-items: center;
        gap: 6px;
        white-space: nowrap;
      }
      .theme-toggle-btn:hover { background: rgba(255,255,255,0.15); }
      .theme-toggle-icon { font-size: 14px; line-height: 1; }

      /* ── Car radio responsive ── */
      @media (max-width: 640px) {
        .cr-unit { padding: 8px; border-radius: 8px; }
        .cr-main-row {
          grid-template-columns: 1fr;
          grid-template-rows: auto auto auto;
          gap: 10px;
        }
        .cr-left-panel {
          flex-direction: row;
          justify-content: center;
          gap: 16px;
        }
        .cr-knob { width: 48px; height: 48px; }
        .cr-knob-inner { width: 40px; height: 40px; }
        .cr-btn-seek { width: 48px; height: 26px; font-size: 9px; }
        .cr-lcd { min-height: 75px; padding: 10px 12px; }
        .cr-lcd-row1 { font-size: 18px; }
        .cr-right-panel { order: 3; }
        .cr-presets { grid-template-columns: repeat(3, 1fr); }
        .cr-bottom-btns { grid-template-columns: 1fr 1fr; }
        .cr-top-row { flex-wrap: wrap; gap: 4px; justify-content: center; }
        .cr-top-label { display: none; }
      }

      /* Mobile: less busy topbar + optimized fullscreen player. Breakpoint: viewport width ≤ 768px.
         S25 Ultra portrait = 480px; ID rule ensures bar stays black when something else overrides. */
      @media (max-width: 768px) {
        #footer-player,
        #player-expanded { background: #000; background-color: #000; color: #fff; }
        :root { --topbar-height: 48px; }
        body.nav-open { overflow: hidden; }
        .site-topbar {
          grid-template-columns: 1fr auto;
          padding: 0 12px;
          gap: 8px;
          min-height: 48px;
          height: 48px;
        }
        .topbar-desktop-only { display: none !important; }
        .topbar-left { gap: 12px; align-items: center; }
        .menu-toggle { display: flex; min-width: 44px; min-height: 44px; }
        .topbar-nav { display: none !important; }
        .topbar-right {
          flex-wrap: nowrap;
          gap: 4px;
          align-items: center;
        }
        .topbar-chat-toggle { min-width: 44px; min-height: 44px; width: 28px; height: 28px; }
        .topbar-search-toggle { min-width: 44px; min-height: 44px; }
        .topbar-search-wrap.expanded .topbar-search-field .topbar-search { width: 100px; min-width: 70px; }
        .main { max-width: 100%; padding: 12px 16px; }
        .live-view-toolbar { flex-direction: column; align-items: stretch; gap: 10px; margin-bottom: 12px; }
        .live-view-toolbar .toolbar-right { justify-content: flex-end; }
        .page-header { font-size: 20px; margin-bottom: 20px; padding-bottom: 10px; border-bottom-width: 1px; }
        .section-title { font-size: 12px; margin: 20px 0 10px; }
        .channels-grid { grid-template-columns: 1fr; gap: 12px; }
        .channel-card { border-width: 1px; }
        .channel-card.now-playing { border-width: 2px; }
        .external-stations-grid { grid-template-columns: 1fr; gap: 12px; }
        .stations-grid-unified { grid-template-columns: 1fr; gap: 12px; }
        .external-station-card { border-width: 1px; }
        .external-station-card.now-playing { border-width: 2px; }
        .stations-search { max-width: 100%; margin-bottom: 12px; border-width: 1px; }
        .footer-player {
          background: #000;
          background-color: #000;
          color: #fff;
          grid-template-columns: 40px 1fr auto;
          grid-template-rows: auto auto;
          gap: 2px 10px;
          padding: 8px 12px 10px;
          height: 112px;
          min-height: 112px;
          border-top-width: 1px;
          align-items: center;
          align-content: center;
        }
        .footer-player .player-bar-tap-area { display: block; position: absolute; inset: 0; z-index: 2; background: transparent; background-color: transparent; border: none; cursor: pointer; }
        .footer-player .player-expand-btn { grid-column: 1; grid-row: 1 / -1; align-self: center; width: 36px; min-width: 36px; height: 36px; min-height: 36px; padding: 0; z-index: 1; }
        .footer-player .cover-wrap { display: none; }
        .footer-player .info {
          min-width: 0;
          grid-column: 2;
          grid-row: 1;
          align-self: end;
          overflow: hidden;
          z-index: 1;
        }
        .footer-player .info .title { font-size: 13px; font-weight: 600; line-height: 1.25; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .footer-player .info .desc,
        .footer-player .info #player-live-badge { display: none !important; }
        .footer-player .status-text { display: block !important; grid-column: 2; grid-row: 2; align-self: start; font-size: 10px; opacity: 0.85; text-align: left; max-width: none; line-height: 1.2; z-index: 1; }
        .footer-player .controls { grid-column: 3; grid-row: 1 / -1; align-self: center; gap: 6px; z-index: 3; position: relative; }
        .footer-player .controls button { min-width: 38px; min-height: 38px; padding: 6px; font-size: 12px; }
        .footer-player .play-pause-btn #play-pause-text { display: none !important; }
        .footer-player .play-pause-btn { min-width: 38px; min-height: 38px; padding: 6px; }
        body { padding-bottom: calc(112px + env(safe-area-inset-bottom, 0)); }
        .player-expanded { bottom: 112px; max-height: calc(100dvh - 112px - env(safe-area-inset-bottom, 0)); padding: 16px 12px; }
        .player-expanded-cover-wrap { width: 120px; height: 120px; }
        .player-expanded-title { font-size: 17px; }
        .player-expanded-controls button { min-width: 48px; min-height: 48px; padding: 12px 18px; }
        .confirm-dialog { max-width: calc(100vw - 24px); margin: 0 12px; }
        .ext-channel-row { border-width: 1px; }
        .ext-channel-row.now-playing { border-width: 2px; }
        .drawer-color-swatches { display: grid; }
        .drawer-color-custom { display: block; }
      }
      /* Smaller phones: viewport width ≤ 480px (e.g. S25 Ultra portrait = 480px). */
      @media (max-width: 480px) {
        #footer-player,
        #player-expanded { background: #000; background-color: #000; color: #fff; }
        :root { --topbar-height: 44px; }
        .site-topbar { height: 44px; min-height: 44px; padding: 0 10px; }
        .topbar-right .topbar-nav-item,
        .topbar-right .color-picker-wrap,
        .topbar-right #client-logout-btn { padding: 5px 6px; font-size: 10px; }
        .topbar-search { width: 72px; min-width: 60px; padding: 4px 6px; font-size: 11px; }
        .player-expanded.fullscreen-mobile { top: 44px; height: calc(100dvh - 44px); }
        .footer-player {
          background: #000;
          background-color: #000;
          color: #fff;
          height: 104px;
          min-height: 104px;
          grid-template-columns: 32px 1fr auto;
          grid-template-rows: auto auto;
          gap: 2px 8px;
          padding: 6px 10px 8px;
          align-items: center;
          align-content: center;
        }
        .footer-player .player-bar-tap-area { display: block; position: absolute; inset: 0; z-index: 2; background: transparent; background-color: transparent; border: none; cursor: pointer; }
        .footer-player .player-expand-btn { z-index: 1; width: 32px; min-width: 32px; height: 32px; min-height: 32px; padding: 0; grid-column: 1; grid-row: 1 / -1; align-self: center; }
        .footer-player .cover-wrap { display: none; }
        .footer-player .info { z-index: 1; min-width: 0; grid-column: 2; grid-row: 1; align-self: end; overflow: hidden; }
        .footer-player .info .title { font-size: 12px; font-weight: 600; line-height: 1.25; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .footer-player .info .desc,
        .footer-player .info #player-live-badge { display: none !important; }
        .footer-player .status-text { display: block !important; z-index: 1; grid-column: 2; grid-row: 2; align-self: start; font-size: 10px; opacity: 0.85; text-align: left; max-width: none; line-height: 1.2; }
        .footer-player .controls { z-index: 3; position: relative; grid-column: 3; grid-row: 1 / -1; align-self: center; gap: 4px; }
        .footer-player .controls button { min-width: 36px; min-height: 36px; padding: 6px; font-size: 11px; }
        .footer-player .play-pause-btn #play-pause-text { display: none !important; }
        .footer-player .play-pause-btn { min-width: 36px; min-height: 36px; padding: 6px; }
        body { padding-bottom: calc(104px + env(safe-area-inset-bottom, 0)); }
        .player-expanded:not(.fullscreen-mobile) { bottom: 104px; max-height: calc(100dvh - 104px - env(safe-area-inset-bottom, 0)); }
        .player-expanded.fullscreen-mobile .player-expanded-cover-wrap { width: 160px; height: 160px; }
        .player-expanded.fullscreen-mobile .player-expanded-title { font-size: 20px; margin-bottom: 8px; }
        .player-expanded.fullscreen-mobile .player-expanded-controls button { min-width: 52px; min-height: 52px; padding: 14px 22px; font-size: 16px; }
        .main { max-width: 100%; padding: 12px 14px; }
      }
    </style>
  </head>
  <body>
    <div class="nav-backdrop" id="nav-backdrop" aria-hidden="true"></div>
    <nav class="site-topbar" id="site-topbar">
      <div class="topbar-left">
        <a href="#live" class="topbar-logo" id="nav-logo">LAF</a>
        <button type="button" class="menu-toggle" id="menu-toggle" aria-label="Open menu" aria-expanded="false">&#9776;</button>
        <div class="topbar-nav">
          <a href="#about" class="topbar-nav-item" id="nav-about">About</a>
          <a href="/broadcaster/" class="topbar-nav-item" id="nav-broadcast">Broadcast</a>
          <a href="#admin" class="topbar-nav-item hidden" id="nav-admin">Admin</a>
        </div>
      </div>
      <div class="topbar-right" id="client-topbar-right">
        <div id="topbar-search-wrap" class="topbar-search-wrap">
          <button type="button" class="topbar-search-toggle" id="topbar-search-toggle" aria-label="Search stations" title="Search"><svg class="search-icon-retro" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><circle cx="6.5" cy="6.5" r="4" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="square"/><path d="M9.5 9.5 L14 14" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="square"/></svg></button>
          <div class="topbar-search-field">
            <input type="text" id="stations-search-topbar" class="stations-search topbar-search" placeholder="Search..." aria-label="Search stations" />
            <button type="button" class="topbar-search-close" id="topbar-search-close" aria-label="Close search">&#215;</button>
          </div>
        </div>
        <button type="button" class="topbar-chat-toggle hidden" id="topbar-chat-toggle" aria-label="Open chat" title="Chat"><svg class="chat-icon-retro" viewBox="0 0 16 14" width="16" height="14" aria-hidden="true"><path d="M1 1 L15 1 L15 9 L9 9 L5 13 L5 9 L1 9 Z" fill="none" stroke="currentColor" stroke-width="1.25" stroke-linejoin="round"/></svg></button>
        <button type="button" class="theme-toggle-btn topbar-desktop-only" id="theme-toggle-btn" aria-label="Switch theme" title="Switch theme">
          <span class="theme-toggle-icon" id="theme-toggle-icon">📻</span>
          <span id="theme-toggle-label">Car Radio</span>
        </button>
        <button type="button" class="popup-btn topbar-desktop-only" id="popup-btn" aria-label="Open mini player" title="Open in popup window">
          <span class="popup-btn-icon">⧉</span>
        </button>
        <div class="color-picker-wrap topbar-desktop-only" id="color-picker-wrap">
          <button type="button" class="color-picker-btn" id="color-picker-btn" aria-label="Choose background color" aria-expanded="false" aria-haspopup="true">
            <span class="color-picker-preview" id="color-picker-preview" style="background: var(--bg);"></span>
            Color
          </button>
        </div>
        <a href="#" id="client-signin-link" class="topbar-nav-item topbar-desktop-only">Sign in</a>
        <span id="client-user-email" class="topbar-nav-item topbar-desktop-only hidden"></span>
        <button type="button" id="client-logout-btn" class="topbar-desktop-only hidden" style="background:transparent;border:1px solid currentColor;color:inherit;padding:6px 12px;font-size:12px;">Logout</button>
        <span id="topbar-clock" class="topbar-clock topbar-desktop-only" aria-live="polite"></span>
      </div>
    </nav>
    <div class="color-picker-dropdown" id="color-picker-dropdown" role="menu" aria-label="Background color">
      <div class="color-picker-swatches" id="color-picker-swatches"></div>
      <div class="color-picker-custom">
        <label for="color-picker-custom-input">Custom</label>
        <input type="color" id="color-picker-custom-input" value="#f5f5f5" aria-label="Custom color" />
      </div>
    </div>
    <div class="nav-drawer" id="nav-drawer" role="dialog" aria-label="Menu">
      <a href="#live" class="topbar-nav-item" data-nav="live">LAF</a>
      <a href="#about" class="topbar-nav-item" data-nav="about">About</a>
      <a href="/broadcaster/" class="topbar-nav-item" id="drawer-broadcast">Broadcast</a>
      <a href="#admin" class="topbar-nav-item hidden" id="drawer-admin">Admin</a>
      <button type="button" class="theme-toggle-btn" id="theme-toggle-btn-drawer" aria-label="Switch theme" style="width:100%;justify-content:center;min-height:44px;">
        <span class="theme-toggle-icon" id="theme-toggle-icon-drawer">📻</span>
        <span id="theme-toggle-label-drawer">Car Radio</span>
      </button>
      <button type="button" class="theme-toggle-btn" id="popup-btn-drawer" aria-label="Open mini player" style="width:100%;justify-content:center;min-height:44px;">
        <span class="popup-btn-icon">⧉</span>
        <span>Mini Player</span>
      </button>
      <button type="button" class="color-picker-btn" id="color-picker-btn-drawer" aria-label="Choose background color">
        <span class="color-picker-preview" style="background: var(--bg);"></span>
        Color
      </button>
      <div class="drawer-color-swatches" id="drawer-color-swatches" aria-label="Background color swatches"></div>
      <div class="drawer-color-custom" id="drawer-color-custom">
        <label for="drawer-color-custom-input">Custom</label>
        <input type="color" id="drawer-color-custom-input" value="#f1c40f" aria-label="Custom color" />
      </div>
      <a href="#" id="client-signin-link-drawer" class="topbar-nav-item">Sign in</a>
      <span id="client-user-email-drawer" class="topbar-nav-item hidden"></span>
      <button type="button" id="client-logout-btn-drawer" class="hidden" style="background:transparent;border:1px solid currentColor;color:inherit;padding:10px 14px;width:100%;text-align:left;font-weight:bold;cursor:pointer;">Logout</button>
    </div>

    <main class="main">
      <div id="view-live" class="view view-live-wrap" role="main">
        <div id="initial-loading-screen" class="initial-loading-screen hidden" aria-live="polite" aria-busy="true">
          <div class="initial-loading-inner">
            <div class="initial-loading-logo">LAF</div>
            <p class="initial-loading-text">Loading stations… Checking streams (about 10 seconds).</p>
            <div class="initial-loading-bar-wrap">
              <div class="initial-loading-bar" id="initial-loading-bar" aria-hidden="true"></div>
            </div>
          </div>
        </div>
        <div class="live-view-toolbar">
          <h1 class="page-header" id="live-page-header">LIVE</h1>
          <div class="toolbar-right">
            <label class="favorites-filter-wrap" id="favorites-filter-wrap">
              <input type="checkbox" id="favorites-filter" aria-label="Show favorites only" />
              <span>Favorites only</span>
            </label>
            <div class="view-mode-switcher" role="tablist" aria-label="View mode">
              <button type="button" class="view-mode-btn active" data-mode="grid" aria-pressed="true">Grid</button>
              <button type="button" class="view-mode-btn" data-mode="list" aria-pressed="false">List</button>
            </div>
          </div>
        </div>
        <div id="stations-view-container">
          <p id="stations-checking-banner" class="stations-checking-banner hidden" aria-live="polite">Checking stream availability…</p>
          <div id="stations-grid" class="stations-grid-unified" role="tabpanel"></div>
          <div id="stations-list" class="stations-list-view hidden" role="tabpanel"></div>
        </div>
      </div>

      <div id="view-about" class="view" role="main">
        <h1 class="page-header">About LAF</h1>
        <div class="page-content">
          <p>LAF is a live audio streaming platform. Broadcast your audio in real time or tune in to live stations from around the world.</p>
          <h2>Broadcast</h2>
          <p>Create an account, set up a channel, and go live. Stream audio from your microphone to anyone listening.</p>
          <h2>Live Stations</h2>
          <p>Browse stations that are currently live. Click to listen, sign in to participate in live chat.</p>
          <h2>Technology</h2>
          <p>LAF uses low-latency WebSocket streaming for real-time audio delivery.</p>
          <h2>Disclaimer</h2>
          <p>This is an independent project trying to aggregate the best independent radios in the world in one place. We do not have rights or exclusivity over any of the material shared through here. If there are any copyright issues or demands, please <a href="mailto:contact@laf.fm" id="about-contact-link">contact us</a>.</p>
        </div>
      </div>

      <div id="view-admin" class="view" role="main">
        <section class="admin-analytics-section" aria-labelledby="admin-analytics-heading">
          <h2 id="admin-analytics-heading" class="section-title">Analytics</h2>
          <div id="admin-analytics" class="admin-analytics-content">
            <p class="admin-analytics-loading" id="admin-analytics-loading">Loading…</p>
            <div class="admin-analytics-stats hidden" id="admin-analytics-stats">
              <div class="admin-analytics-stat"><span class="admin-analytics-stat-value" id="admin-analytics-visitors">—</span><span class="admin-analytics-stat-label">Unique visitors</span></div>
              <div class="admin-analytics-stat"><span class="admin-analytics-stat-value" id="admin-analytics-hours">—</span><span class="admin-analytics-stat-label">Hours of audio transmitted</span></div>
            </div>
            <h3 class="admin-analytics-subtitle" id="admin-analytics-most-tuned-label">Most tuned radios</h3>
            <div id="admin-analytics-most-tuned" class="admin-analytics-table-wrap"></div>
          </div>
        </section>
        <h1 class="page-header">Add radio station</h1>
        <p style="margin-bottom: 16px; color: var(--text-muted);">Paste a radio website URL (e.g. https://www.subtleradio.com/) or a direct stream URL. We’ll find the live stream and add it to the feed.</p>
        <div class="page-content" style="max-width: 520px;">
          <div class="form-group">
            <label for="admin-url">Website or stream URL</label>
            <input type="url" id="admin-url" placeholder="https://www.example.com or https://example.com/stream.mp3" />
          </div>
          <div id="admin-status" class="status info hidden" style="margin-bottom: 12px;"></div>
          <button type="button" id="admin-submit-btn">Add station</button>
        </div>
        <div class="page-content admin-stations-section" style="max-width: 900px; margin-top: 32px;">
          <h2 class="section-title">All stations on the site</h2>
          <p style="margin-bottom: 12px; color: var(--text-muted); font-size: 13px;">Search and filter, play to test, then edit or delete. Use &quot;Delete selected&quot; to remove multiple stations at once.</p>
          <div class="admin-toolbar">
            <div class="admin-toolbar-row">
              <label for="admin-search" class="admin-label">Search</label>
              <input type="text" id="admin-search" placeholder="Name, URL, description…" class="admin-search-input" />
              <label for="admin-filter-source" class="admin-label">Source</label>
              <select id="admin-filter-source" class="admin-select" aria-label="Filter by source">
                <option value="">All</option>
                <option value="builtin">Built-in</option>
                <option value="api">API</option>
              </select>
              <label for="admin-filter-bundle" class="admin-label">Bundle</label>
              <select id="admin-filter-bundle" class="admin-select" aria-label="Filter by bundle">
                <option value="">All bundles</option>
              </select>
              <button type="button" id="admin-delete-selected" class="admin-delete-selected hidden">Delete selected</button>
            </div>
          </div>
          <div id="admin-stations-list" class="admin-stations-list"></div>
        </div>
      </div>
    </main>

    <footer class="footer-player hidden" id="footer-player">
      <button type="button" class="player-bar-tap-area" id="player-bar-tap-area" aria-hidden="true" tabindex="-1"></button>
      <button type="button" class="player-expand-btn" id="player-expand-btn" aria-label="Expand player" aria-expanded="false" title="Expand">&#8964;</button>
      <div class="cover-wrap placeholder" id="player-cover-wrap">
        <img id="player-cover" class="player-cover" alt="" />
        <span id="player-cover-initial" class="cover-initial hidden" aria-hidden="true"></span>
      </div>
      <div class="info">
        <div class="title" id="now-playing-title">Not playing</div>
        <span id="player-live-badge" class="hidden" style="font-size:10px;margin-left:6px;">LIVE</span>
        <div class="desc" id="now-playing-desc"></div>
      </div>
      <div class="controls">
        <button type="button" id="btn-prev-station" class="external-only hidden" title="Previous">&#9664;</button>
        <button type="button" id="btn-play-pause" style="min-width:90px;" class="play-pause-btn"><span id="play-pause-icon" class="play-pause-icon"></span> <span id="play-pause-text">Start</span></button>
        <button type="button" id="btn-next-station" class="external-only hidden" title="Next">&#9654;</button>
      </div>
      <div class="status-text" id="player-status-text">Ready to listen</div>
    </footer>
    <div class="player-expanded" id="player-expanded" aria-hidden="true">
      <div class="player-expanded-inner">
        <div class="player-expanded-cover-wrap" id="player-expanded-cover-wrap">
          <img id="player-expanded-cover" alt="" />
        </div>
        <div class="player-expanded-info">
          <h2 class="player-expanded-title" id="player-expanded-title">Not playing</h2>
          <div class="player-expanded-location" id="player-expanded-location"></div>
          <div class="player-expanded-desc" id="player-expanded-desc"></div>
          <a id="player-expanded-website-link" href="#" target="_blank" rel="noopener" class="player-expanded-link">Visit website</a>
          <p id="player-expanded-buffer-hint" class="player-expanded-buffer-hint hidden">If playback stalls, try another channel or stream.</p>
        </div>
        <div class="player-expanded-controls">
          <button type="button" id="btn-prev-expanded" class="external-only hidden" title="Previous">&#9664;</button>
          <button type="button" id="btn-play-pause-expanded" style="min-width:100px;" class="play-pause-btn"><span id="play-pause-icon-expanded" class="play-pause-icon"></span> <span id="play-pause-text-expanded">Start</span></button>
          <button type="button" id="btn-next-expanded" class="external-only hidden" title="Next">&#9654;</button>
        </div>
        <div class="player-expanded-minimize" style="display: none;">
          <button type="button" class="player-expanded-minimize-btn" id="player-expanded-minimize-btn" aria-label="Minimize player">&#8963;</button>
        </div>
      </div>
    </div>
    <div id="suggest-overlay" class="confirm-overlay" aria-hidden="true">
      <div class="confirm-dialog" style="max-width: 400px;">
        <div class="confirm-title">Suggest a radio</div>
        <p style="margin-bottom: 12px; font-size: 13px; color: var(--text-muted);">Send us the URL of a radio you’d like to see here.</p>
        <div class="form-group" style="margin-bottom: 12px;">
          <label for="suggest-url">Radio website or stream URL</label>
          <input type="url" id="suggest-url" placeholder="https://..." style="width: 100%; padding: 8px;" />
        </div>
        <div class="form-group" style="margin-bottom: 16px;">
          <label for="suggest-message">Message (optional)</label>
          <input type="text" id="suggest-message" placeholder="Any note for us..." style="width: 100%; padding: 8px;" />
        </div>
        <div id="suggest-status" class="status info hidden" style="margin-bottom: 12px;"></div>
        <div class="confirm-buttons">
          <button type="button" id="suggest-cancel">Cancel</button>
          <button type="button" id="suggest-submit">Send</button>
        </div>
      </div>
    </div>
    <div id="chat-global-overlay" class="chat-global-overlay" aria-hidden="true">
      <div class="chat-global-header">Chat <button type="button" class="chat-global-close" id="chat-global-close" aria-label="Close">&#215;</button></div>
      <div id="chat-global-messages" class="chat-messages"></div>
      <div id="chat-global-signin" class="chat-signin-prompt hidden" style="padding: 12px;">Sign in to chat</div>
      <div id="chat-global-input-row" class="chat-input-row hidden" style="padding: 8px; border-top: 1px solid var(--border);">
        <input type="text" id="chat-global-input" class="chat-input" placeholder="Type a message..." maxlength="2000" style="flex: 1;" />
        <button type="button" id="chat-global-send" class="chat-send">Send</button>
      </div>
    </div>
    <div id="chat-global-fullscreen" class="chat-global-fullscreen" aria-hidden="true">
      <div class="chat-global-header">Chat <button type="button" class="chat-global-fullscreen-close" id="chat-global-fullscreen-close" aria-label="Close">&#215;</button></div>
      <div id="chat-global-fullscreen-messages" class="chat-messages"></div>
      <div id="chat-global-fullscreen-signin" class="chat-signin-prompt hidden" style="padding: 12px;">Sign in to chat</div>
      <div id="chat-global-fullscreen-input-row" class="chat-input-row hidden" style="padding: 12px; padding-bottom: calc(12px + env(safe-area-inset-bottom, 0)); border-top: 1px solid var(--border);">
        <input type="text" id="chat-global-fullscreen-input" class="chat-input" placeholder="Type a message..." maxlength="2000" style="flex: 1;" />
        <button type="button" id="chat-global-fullscreen-send" class="chat-send">Send</button>
      </div>
    </div>

    <div class="player-detail" id="player-detail">
      <div class="stat-grid" id="player-stat-grid">
        <div class="stat-item"><div class="stat-label">Tier</div><div id="stat-tier" class="stat-value">-</div></div>
        <div class="stat-item"><div class="stat-label">Loss (2s)</div><div id="stat-loss" class="stat-value">-</div></div>
        <div class="stat-item"><div class="stat-label">Buffer</div><div id="stat-buffer" class="stat-value">-</div></div>
        <div class="stat-item"><div class="stat-label">Late Rate</div><div id="stat-late" class="stat-value">-</div></div>
        <div class="stat-item"><div class="stat-label">Est Latency</div><div id="stat-latency" class="stat-value">-</div></div>
        <div class="stat-item"><div class="stat-label">Bitrate</div><div id="stat-kbps" class="stat-value">-</div></div>
      </div>
      <div id="external-stream-actions" class="hidden" style="margin-top:8px;"><a id="external-visit-website" href="#" target="_blank" rel="noopener">Visit website</a></div>
      <p id="now-playing-program-wrap" class="hidden" style="font-size:11px;margin-top:8px;"><span id="now-playing-program"></span></p>
      <div class="chat-panel" id="player-chat-panel">
        <div class="chat-title">Live chat</div>
        <div id="chat-messages" class="chat-messages"></div>
        <div id="chat-signin-prompt" class="chat-signin-prompt">Sign in to participate in chat</div>
        <div id="chat-input-row" class="chat-input-row hidden">
          <input type="text" id="chat-input" class="chat-input" placeholder="Type a message..." maxlength="2000" />
          <button type="button" id="chat-send" class="chat-send">Send</button>
        </div>
      </div>
    </div>

    <div id="auth-overlay" class="confirm-overlay" aria-hidden="true">
      <div class="confirm-dialog">
        <div class="confirm-title">Sign in to chat</div>
        <div id="auth-tabs" style="display:flex;gap:8px;margin-bottom:12px;">
          <button type="button" id="auth-tab-login" class="auth-tab active">Login</button>
          <button type="button" id="auth-tab-register" class="auth-tab">Register</button>
        </div>
        <div id="auth-login-form">
          <div class="form-group"><label>Email</label><input type="email" id="auth-login-email" placeholder="your@email.com" /></div>
          <div class="form-group"><label>Password</label><input type="password" id="auth-login-password" placeholder="password" /></div>
          <button type="button" id="auth-login-btn">Login</button>
        </div>
        <div id="auth-register-form" class="hidden">
          <div class="form-group"><label>Email</label><input type="email" id="auth-register-email" placeholder="your@email.com" /></div>
          <div class="form-group"><label>Password</label><input type="password" id="auth-register-password" placeholder="8+ chars" /></div>
          <button type="button" id="auth-register-btn">Register</button>
        </div>
        <div id="auth-error" class="auth-error hidden"></div>
        <button type="button" id="auth-close" style="margin-top:12px;">Close</button>
      </div>
    </div>
    <div id="confirm-overlay" class="confirm-overlay" aria-hidden="true">
      <div class="confirm-dialog">
        <div class="confirm-title" id="confirm-title">Confirm</div>
        <div class="confirm-message" id="confirm-message"></div>
        <div class="confirm-buttons">
          <button type="button" id="confirm-cancel-btn">Cancel</button>
          <button type="button" id="confirm-ok-btn">OK</button>
        </div>
      </div>
    </div>

    <!-- ═══════════════════════════════════════════════════════
         CAR RADIO UI – Full-page skeuomorphic head unit
         Hidden by default; shown when theme-car-radio is active
         ═══════════════════════════════════════════════════════ -->
    <div id="car-radio-ui" class="car-radio-ui" aria-label="Car Radio Interface" style="display:none;">
      <div class="cr-unit">
        <!-- Top button row -->
        <div class="cr-top-row">
          <div class="cr-btn-group cr-btn-group-left">
            <button type="button" class="cr-btn cr-btn-small" id="cr-btn-theme" title="Switch theme">THEME</button>
            <button type="button" class="cr-btn cr-btn-small" id="cr-btn-info" title="Browse stations">STATIONS</button>
          </div>
          <div class="cr-top-label">
            <span class="cr-rds-badge">RDS</span>
            <span class="cr-top-label-text">LAF RADIO</span>
          </div>
          <div class="cr-btn-group cr-btn-group-right">
            <button type="button" class="cr-btn cr-btn-small" id="cr-btn-seek-back" title="Previous station">&#9664;&#9664;</button>
            <button type="button" class="cr-btn cr-btn-small" id="cr-btn-seek-fwd" title="Next station">&#9654;&#9654;</button>
            <button type="button" class="cr-btn cr-btn-small" id="cr-btn-src" title="Source">SRC</button>
            <button type="button" class="cr-btn cr-btn-small cr-btn-pop" id="cr-btn-pop" title="Open in mini popup window">POP</button>
          </div>
        </div>

        <!-- Main area -->
        <div class="cr-main-row">
          <!-- Left: Volume knob + nav -->
          <div class="cr-left-panel">
            <div class="cr-knob-area">
              <div class="cr-knob-labels">
                <span class="cr-knob-label">SEL</span>
                <span class="cr-knob-label">VOL</span>
              </div>
              <div class="cr-knob" id="cr-knob" title="Volume">
                <div class="cr-knob-inner">
                  <div class="cr-knob-ring"></div>
                  <div class="cr-knob-dot"></div>
                </div>
              </div>
            </div>
            <div class="cr-nav-seek">
              <button type="button" class="cr-btn cr-btn-seek" id="cr-nav-left" title="Previous station">&#9664;&#9664;</button>
              <button type="button" class="cr-btn cr-btn-seek" id="cr-nav-right" title="Next station">&#9654;&#9654;</button>
            </div>
            <div class="cr-vol-display" id="cr-vol-display">VOL 70</div>
          </div>

          <!-- Center: LCD display + slot -->
          <div class="cr-center-panel">
            <div class="cr-lcd" id="cr-lcd">
              <div class="cr-lcd-row1" id="cr-lcd-row1">LAF RADIO</div>
              <div class="cr-lcd-row2" id="cr-lcd-row2">Select a station</div>
              <div class="cr-lcd-row3" id="cr-lcd-row3">
                <span class="cr-lcd-freq" id="cr-lcd-freq">FM --.-</span>
                <span class="cr-lcd-status" id="cr-lcd-status">STANDBY</span>
              </div>
              <div class="cr-lcd-meter" id="cr-lcd-meter">
                <div class="cr-lcd-meter-fill" id="cr-lcd-meter-fill"></div>
              </div>
            </div>
            <div class="cr-slot">
              <div class="cr-slot-opening"></div>
              <div class="cr-slot-label">
                <span class="cr-brand-badge">LAF</span>
                <span class="cr-model-text">INTERNET RADIO</span>
              </div>
            </div>
          </div>

          <!-- Right: Preset buttons -->
          <div class="cr-right-panel">
            <div class="cr-presets">
              <button type="button" class="cr-preset-btn" data-preset="0" id="cr-preset-1"><span class="cr-preset-num">1</span><span class="cr-preset-label"></span></button>
              <button type="button" class="cr-preset-btn" data-preset="1" id="cr-preset-2"><span class="cr-preset-num">2</span><span class="cr-preset-label"></span></button>
              <button type="button" class="cr-preset-btn" data-preset="2" id="cr-preset-3"><span class="cr-preset-num">3</span><span class="cr-preset-label"></span></button>
              <button type="button" class="cr-preset-btn" data-preset="3" id="cr-preset-4"><span class="cr-preset-num">4</span><span class="cr-preset-label"></span></button>
              <button type="button" class="cr-preset-btn" data-preset="4" id="cr-preset-5"><span class="cr-preset-num">5</span><span class="cr-preset-label"></span></button>
              <button type="button" class="cr-preset-btn" data-preset="5" id="cr-preset-6"><span class="cr-preset-num">6</span><span class="cr-preset-label"></span></button>
            </div>
            <div class="cr-bottom-btns">
              <button type="button" class="cr-btn cr-btn-band" id="cr-btn-play">&#9654; PLAY</button>
              <button type="button" class="cr-btn cr-btn-band" id="cr-btn-stop">&#9632; STOP</button>
            </div>
          </div>
        </div>
      </div>
      <!-- Station list overlay (hidden, toggled by INFO) -->
      <div class="cr-station-list" id="cr-station-list" style="display:none;">
        <div class="cr-station-list-header">
          <span class="cr-station-list-title">STATIONS</span>
          <button type="button" class="cr-btn cr-btn-small" id="cr-station-list-close">CLOSE</button>
        </div>
        <div class="cr-station-list-body" id="cr-station-list-body"></div>
      </div>
    </div>

    <!-- ═══════════════════════════════════════════════════════
         iPOD UI – Full-page skeuomorphic iPod Classic
         Hidden by default; shown when theme-ipod is active
         ═══════════════════════════════════════════════════════ -->
    <div id="ipod-ui" class="ipod-ui" aria-label="iPod Interface" style="display:none;">
      <div class="ipod-body">
        <!-- Screen -->
        <div class="ipod-screen">
          <div class="ipod-statusbar">
            <span class="ipod-statusbar-play" id="ipod-statusbar-play"></span>
            <span class="ipod-statusbar-title" id="ipod-statusbar-title">iPod</span>
            <div class="ipod-statusbar-battery"><div class="ipod-statusbar-battery-fill"></div></div>
          </div>
          <div class="ipod-content">
            <!-- Menu view -->
            <div class="ipod-menu" id="ipod-menu-view">
              <div class="ipod-menu-header" id="ipod-menu-header">LAF Radio</div>
              <div class="ipod-menu-list" id="ipod-menu-list"></div>
            </div>
            <!-- Now Playing view -->
            <div class="ipod-nowplaying ipod-hidden" id="ipod-nowplaying">
              <div class="ipod-np-top">
                <div class="ipod-np-art" id="ipod-np-art">
                  <img id="ipod-np-art-img" alt="" style="display:none;" />
                  <span class="ipod-np-art-initial" id="ipod-np-art-initial">?</span>
                </div>
                <div class="ipod-np-info">
                  <div class="ipod-np-title" id="ipod-np-title">Not Playing</div>
                  <div class="ipod-np-artist" id="ipod-np-artist">—</div>
                  <div class="ipod-np-album" id="ipod-np-album">LAF Radio</div>
                </div>
              </div>
              <div class="ipod-np-progress">
                <div class="ipod-np-bar-wrap"><div class="ipod-np-bar-fill" id="ipod-np-bar"></div></div>
                <div class="ipod-np-times">
                  <span id="ipod-np-time-elapsed">0:00</span>
                  <span id="ipod-np-time-remain">LIVE</span>
                </div>
              </div>
              <div class="ipod-np-volume">
                <span class="ipod-np-vol-icon">🔈</span>
                <div class="ipod-np-vol-bar"><div class="ipod-np-vol-fill" id="ipod-np-vol-fill"></div></div>
                <span class="ipod-np-vol-icon">🔊</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Click Wheel -->
        <div class="ipod-wheel-area">
          <div class="ipod-wheel" id="ipod-wheel">
            <span class="ipod-wheel-label ipod-wheel-label-menu">MENU</span>
            <span class="ipod-wheel-label ipod-wheel-label-fwd">▶▶</span>
            <span class="ipod-wheel-label ipod-wheel-label-back">◀◀</span>
            <span class="ipod-wheel-label ipod-wheel-label-play">▶❚❚</span>
            <button type="button" class="ipod-wheel-zone ipod-zone-menu" id="ipod-btn-menu" aria-label="Menu">M</button>
            <button type="button" class="ipod-wheel-zone ipod-zone-fwd" id="ipod-btn-fwd" aria-label="Next">F</button>
            <button type="button" class="ipod-wheel-zone ipod-zone-back" id="ipod-btn-back" aria-label="Previous">B</button>
            <button type="button" class="ipod-wheel-zone ipod-zone-play" id="ipod-btn-play" aria-label="Play/Pause">P</button>
            <button type="button" class="ipod-center-btn" id="ipod-btn-center" aria-label="Select"></button>
          </div>
        </div>
      </div>
    </div>

    <script type="module" src="/src/main.ts"></script>
  </body>
</html>
