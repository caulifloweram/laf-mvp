<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>LAF - Listen</title>
    <style>
      /* Macintosh 1984â€“inspired UI: black & white, striped title bars, Chicago-style */
      * { margin: 0; padding: 0; box-sizing: border-box; }

      :root {
        --mac-white: #fff;
        --mac-black: #000;
        --mac-gray: #808080;
        --mac-light-gray: #c0c0c0;
        --mac-bg: #a0a0a0;
        --mac-title-stripe: #e0e0e0;
      }

      body {
        font-family: Chicago, "Charcoal", "Lucida Grande", system-ui, -apple-system, sans-serif;
        background: var(--mac-bg);
        color: var(--mac-black);
        min-height: 100vh;
        padding: 0;
        -webkit-font-smoothing: none;
        font-smoothing: none;
      }

      /* Menu bar (classic Mac top strip) */
      .desktop-taskbar {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        background: var(--mac-black);
        color: var(--mac-white);
        padding: 6px 12px;
        font-size: 12px;
        display: flex;
        gap: 12px;
        z-index: 10;
      }
      .desktop-taskbar button {
        background: transparent;
        border: 1px solid var(--mac-white);
        color: var(--mac-white);
        padding: 4px 10px;
        font-size: 11px;
        cursor: pointer;
        box-shadow: none;
      }
      .desktop-taskbar button:hover { background: var(--mac-gray); }

      /* Desktop: windows are positioned absolutely */
      .desktop {
        position: relative;
        min-height: 100vh;
        padding: 24px;
      }

      /* Window: white content, black border, solid title bar */
      .mac-window,
      .player-section {
        position: absolute;
        min-width: 320px;
        max-width: 560px;
        z-index: 1;
        background: var(--mac-white);
        border: 2px solid var(--mac-black);
        border-radius: 6px;
        overflow: hidden;
        box-shadow: 2px 2px 0 var(--mac-gray);
      }
      .mac-window.bring-front,
      .player-section.bring-front { z-index: 2; }

      .mac-window-title {
        background: var(--mac-light-gray);
        border-bottom: 1px solid var(--mac-black);
        padding: 6px 10px 6px 52px;
        font-size: 13px;
        font-weight: bold;
        position: relative;
        cursor: move;
        user-select: none;
      }
      .mac-window-title .live-badge { margin-left: 8px; }
      .mac-window-title .close-box,
      .mac-window-title .minimize-box {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        width: 14px;
        height: 14px;
        border: 1px solid var(--mac-black);
        border-radius: 1px;
        background: var(--mac-white);
        cursor: pointer;
      }
      .mac-window-title .close-box { left: 6px; }
      .mac-window-title .minimize-box {
        left: 24px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .mac-window-title .minimize-box::after {
        content: "";
        width: 8px;
        height: 2px;
        background: var(--mac-black);
      }

      .mac-window-body { padding: 16px 20px 20px; }

      h1 {
        font-size: 18px;
        font-weight: bold;
        margin-bottom: 16px;
        color: var(--mac-black);
      }

      .channels-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
        gap: 16px;
        margin-bottom: 24px;
      }

      .channel-card {
        background: var(--mac-white);
        border: 2px solid var(--mac-black);
        border-radius: 6px;
        padding: 0;
        cursor: pointer;
        overflow: hidden;
        box-shadow: 2px 2px 0 var(--mac-gray);
      }
      .channel-card:hover { background: var(--mac-light-gray); }
      .channel-card .mac-window-title { padding: 6px 10px 6px 28px; cursor: default; }
      .channel-card .mac-window-body { padding: 12px 14px; }

      .channel-title {
        font-size: 13px;
        font-weight: bold;
        margin-bottom: 6px;
        color: var(--mac-black);
      }

      .channel-desc {
        font-size: 12px;
        color: var(--mac-gray);
        line-height: 1.4;
      }

      .live-badge {
        display: inline-block;
        background: var(--mac-black);
        color: var(--mac-white);
        padding: 2px 8px;
        border-radius: 4px;
        font-size: 11px;
        font-weight: bold;
        margin-top: 6px;
      }

      .player-section {
        border: 2px solid var(--mac-black);
        border-radius: 6px;
        background: var(--mac-white);
        overflow: hidden;
        margin-top: 20px;
        box-shadow: 2px 2px 0 var(--mac-gray);
      }
      .player-section .mac-window-body { padding: 20px; }

      .player-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 16px;
        flex-wrap: wrap;
        gap: 12px;
      }

      .player-header h2 { font-size: 14px; margin: 0 0 4px 0; }
      .player-header p { font-size: 12px; color: var(--mac-gray); }

      .stat-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
        gap: 10px;
        margin-top: 16px;
      }

      .stat-item {
        background: var(--mac-light-gray);
        border: 1px solid var(--mac-black);
        border-radius: 4px;
        padding: 10px 12px;
      }

      .stat-label {
        font-size: 10px;
        color: var(--mac-gray);
        margin-bottom: 4px;
        text-transform: uppercase;
      }

      .stat-value {
        font-size: 14px;
        font-weight: bold;
        font-variant-numeric: tabular-nums;
      }

      /* Classic Mac buttons: rounded rect, black border, white fill */
      button {
        background: var(--mac-white);
        color: var(--mac-black);
        border: 2px solid var(--mac-black);
        border-radius: 6px;
        padding: 8px 16px;
        font-size: 12px;
        font-weight: bold;
        font-family: inherit;
        cursor: pointer;
        box-shadow: 2px 2px 0 var(--mac-black);
      }
      button:hover { background: var(--mac-light-gray); }
      button:active {
        box-shadow: none;
        transform: translate(1px, 1px);
      }
      button:disabled {
        background: var(--mac-light-gray);
        color: var(--mac-gray);
        cursor: not-allowed;
        box-shadow: 1px 1px 0 var(--mac-gray);
      }
      button[style*="background: #ef4444"],
      button.danger {
        background: var(--mac-white) !important;
        color: var(--mac-black) !important;
        border: 2px solid var(--mac-black) !important;
      }
      button.danger:hover { background: var(--mac-light-gray) !important; }

      .status {
        padding: 10px 14px;
        border: 1px solid var(--mac-black);
        border-radius: 4px;
        font-size: 12px;
        margin-bottom: 12px;
      }
      .status.success { background: var(--mac-light-gray); }
      .status.error { background: var(--mac-white); }
      .status.info { background: var(--mac-light-gray); }
      .status.playing { background: var(--mac-light-gray); }
      .status.stopped { background: var(--mac-white); }

      .hidden { display: none; }
      .mac-window.window-closed,
      .player-section.window-closed { display: none !important; }

      @media (max-width: 768px) {
        .container { padding: 12px; }
        .channels-grid { grid-template-columns: 1fr; }
        .stat-grid { grid-template-columns: repeat(2, 1fr); }
      }
    </style>
  </head>
  <body>
    <div class="desktop" id="desktop">
      <div class="mac-window" id="window-channels" data-window-id="channels" style="left: 24px; top: 24px;">
        <div class="mac-window-title">
          <span class="close-box" title="Close"></span>
          <span class="minimize-box" title="Minimize"></span>
          Live Channels
        </div>
        <div class="mac-window-body">
          <div id="channels-grid" class="channels-grid"></div>
        </div>
      </div>
      <div id="player-section" class="player-section hidden" data-window-id="player" style="left: 24px; top: 320px;">
        <div class="mac-window-title">
          <span class="close-box" title="Close"></span>
          <span class="minimize-box" title="Minimize"></span>
          <span id="now-playing-title">Not playing</span>
          <span id="player-live-badge" class="live-badge hidden">LIVE</span>
        </div>
        <div class="mac-window-body">
        <div class="player-header">
          <div style="flex: 1;">
            <p id="now-playing-desc" style="font-size: 12px; color: #808080;"></p>
          </div>
          <div style="display: flex; gap: 8px;">
            <button id="btn-start" style="min-width: 100px;">
              <span id="play-icon">&#9654;</span> <span id="play-text">Start</span>
            </button>
            <button id="btn-stop" class="hidden danger" style="min-width: 100px;">
              <span>&#9632;</span> Stop
            </button>
          </div>
        </div>
        
        <div id="player-status" class="status info">
          <span id="player-status-icon">&#10074;&#10074;</span>
          <span id="player-status-text">Ready to listen</span>
        </div>
        <div class="stat-grid">
          <div class="stat-item">
            <div class="stat-label">Tier</div>
            <div id="stat-tier" class="stat-value">-</div>
          </div>
          <div class="stat-item">
            <div class="stat-label">Loss (2s)</div>
            <div id="stat-loss" class="stat-value">-</div>
          </div>
          <div class="stat-item">
            <div class="stat-label">Buffer</div>
            <div id="stat-buffer" class="stat-value">-</div>
          </div>
          <div class="stat-item">
            <div class="stat-label">Late Rate</div>
            <div id="stat-late" class="stat-value">-</div>
          </div>
          <div class="stat-item">
            <div class="stat-label">Est Latency</div>
            <div id="stat-latency" class="stat-value">-</div>
          </div>
          <div class="stat-item">
            <div class="stat-label">Bitrate</div>
            <div id="stat-kbps" class="stat-value">-</div>
          </div>
        </div>
        </div>
      </div>
    </div>
    <div class="desktop-taskbar" id="taskbar">
      <button type="button" id="taskbar-channels" class="hidden">Live Channels</button>
      <button type="button" id="taskbar-player" class="hidden">Player</button>
    </div>
    <script type="module" src="/src/main.ts"></script>
    <script type="module" src="/src/window-ui.ts"></script>
  </body>
</html>
